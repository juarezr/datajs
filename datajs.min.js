(function(n,t){var vt=n.datajs||{},r=n.OData||{},ao,vo,rr,ur,fi,yy,fp;typeof define=="function"&&define.amd?(define("datajs",vt),define("OData",r)):(n.datajs=vt,n.OData=r);vt.version={major:1,minor:3,build:0};var go=function(t){return n.ActiveXObject?new n.ActiveXObject(t):null},et=function(n){return n!==null&&n!==t},or=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return!0;return!1},it=function(n,i){return n!==t?n:i},o=function(t){if(arguments.length===1){n.setTimeout(t,0);return}var i=Array.prototype.slice.call(arguments,1);n.setTimeout(function(){t.apply(this,i)},0)},ns=function(n,t){function i(){}return i.prototype=t.prototype,n.prototype=new i,n},g=function(n,t){for(var i in t)n[i]=t[i];return n},sr=function(n,t){if(n)for(var i=0,r=n.length;i<r;i++)if(t(n[i]))return n[i];return null},e=function(n){return Object.prototype.toString.call(n)==="[object Array]"},af=function(n){return Object.prototype.toString.call(n)==="[object Date]"},vf=function(n){return typeof n=="object"},s=function(n){return parseInt(n,10)},uu=function(n,t,i){n.hasOwnProperty(t)&&(n[i]=n[t],delete n[t])},fu=function(n){throw n;},ts=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},yf=function(n,i){return n!==t?n:i},ep=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,is=["scheme","authority","path","query","fragment"],pf=function(n){var i={isAbsolute:!1},r,t,u;if(n){if(r=ep.exec(n),r)for(t=0,u=is.length;t<u;t++)r[t+1]&&(i[is[t]]=r[t+1]);i.scheme&&(i.isAbsolute=!0)}return i},rs=function(n){return"".concat(n.scheme||"",n.authority||"",n.path||"",n.query||"",n.fragment||"")},op=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/,sp=/%[0-9A-F]{2}/ig,hp=function(n){var i=pf(n),r=i.scheme,u=i.authority,t;return r&&(i.scheme=r.toLowerCase(),u&&(t=op.exec(u),t&&(i.authority="//"+(t[1]?t[1]+"@":"")+t[2].toLowerCase()+(t[3]?":"+t[3]:"")))),n=rs(i),n.replace(sp,function(n){return n.toLowerCase()})},c=function(n,t){var i,u,r,f;return t?(i=pf(n),i.isAbsolute)?n:(u=pf(t),r={},i.authority?(r.authority=i.authority,f=i.path,r.query=i.query):(i.path?(f=i.path.charAt(0)==="/"?i.path:cp(i.path,u.path),r.query=i.query):(f=u.path,r.query=i.query||u.query),r.authority=u.authority),r.path=lp(f),r.scheme=u.scheme,r.fragment=i.fragment,rs(r)):n},cp=function(n,t){var i="/",r;return t&&(r=t.lastIndexOf("/"),i=t.substring(0,r),i.charAt(i.length-1)!=="/"&&(i=i+"/")),i+n},lp=function(n){for(var t="",r="",i;n;)n.indexOf("..")===0||n.indexOf(".")===0?n=n.replace(/^\.\.?\/?/g,""):n.indexOf("/..")===0?(n=n.replace(/^\/\..\/?/g,"/"),i=t.lastIndexOf("/"),t=i===-1?"":t.substring(0,i)):n.indexOf("/.")===0?n=n.replace(/^\/\.\/?/g,"/"):(r=n,i=n.indexOf("/",1),i!==-1&&(r=n.substring(0,i)),t=t+r,n=n.replace(r,""));return t},ap=function(i){var r=[],o,u,f,s,e,h;if(n.atob===t)r=vp(i);else for(o=n.atob(i),u=0;u<o.length;u++)r.push(o.charCodeAt(u));for(f="",s="0123456789ABCDEF",e=0;e<r.length;e++)h=r[e],f+=s[h>>4],f+=s[h&15];return f},vp=function(n){for(var r,u,f,e,o,i="",t=0;t<n.length;t++)r=yp(n[t]),u="",r!==null&&(u=r.toString(2),i+=pp(u));for(f=[],e=parseInt(i.length/8,10),t=0;t<e;t++)o=parseInt(i.substring(t*8,(t+1)*8),2),f.push(o);return f},yp=function(n){var t=n.charCodeAt(0),i=65;return t>=65&&t<=90?t-i:t>=97&&t<=122?t-i-6:t>=48&&t<=57?t+4:n=="+"?62:n=="/"?63:null},pp=function(n){while(n.length<6)n="0"+n;return n},eu="http://",hr=eu+"www.w3.org/",us=hr+"1999/xhtml",cr=hr+"2000/xmlns/",yi=hr+"XML/1998/namespace",fs=eu+"www.mozilla.org/newlayout/xml/parsererror.xml",wp=function(n){return/(^\s)|(\s$)/.test(n)},bp=function(n){return n===null||/^\s*$/.test(n)},kp=function(n){while(n!==null&&n.nodeType===1){var t=ot(n,"space",yi);if(t==="preserve")return!0;if(t==="default")break;else n=n.parentNode}return!1},dp=function(n){var t=n.nodeName;return t=="xmlns"||t.indexOf("xmlns:")===0},ou=function(n,t,i){try{n.setProperty(t,i)}catch(r){}},gp=function(){var n=go("Msxml2.DOMDocument.3.0");return n&&(ou(n,"ProhibitDTD",!0),ou(n,"MaxElementDepth",256),ou(n,"AllowDocumentFunction",!1),ou(n,"AllowXsltScript",!1)),n},es=function(){try{var n=go("Msxml2.DOMDocument.6.0");return n&&(n.async=!0),n}catch(t){return gp()}},nw=function(n){var t=es(),i;return t?(t.loadXML(n),i=t.parseError,i.errorCode!==0&&lr(i.reason,i.srcText,n),t):null},lr=function(n,t,i){typeof n=="string"&&(n={message:n});throw g(n,{srcText:t||"",errorXmlText:i||""});},su=function(t){var s=n.DOMParser&&new n.DOMParser,r,e,l;if(!s)return r=nw(t),r||lr("XML DOM parser not supported"),r;try{r=s.parseFromString(t,"text/xml")}catch(v){lr(v,"",t)}var i=r.documentElement,h=i.namespaceURI,c=f(i);if(c==="parsererror"&&h===fs&&(e=b(i,fs,"sourcetext"),l=e?bi(e):"",lr(k(i)||"",l,t)),c==="h3"&&h===us||rw(i,us,"h3")){for(var o="",a=[],u=i.firstChild;u;)u.nodeType===1&&(o+=k(u)||""),a.push(u.nextSibling),u=u.firstChild||a.shift();o+=k(i)||"";lr(o,"",t)}return r},yt=function(n,t){return n?n+":"+t:t},tw=function(n,t){if(wp(t.data)){var i=wi(n,yi,"space");i||(i=oi(n.ownerDocument,yi,yt("xml","space")),l(n,i));i.value="preserve"}return n.appendChild(t),n},pi=function(n,t){for(var r=n.attributes,i=0,u=r.length;i<u;i++)t(r.item(i))},ot=function(n,t,i){var r=wi(n,t,i);return r?bi(r):null},wi=function(n,t,i){var r=n.attributes;return r.getNamedItemNS?r.getNamedItemNS(i||null,t):r.getQualifiedItem(t,i)||null},rt=function(n,t){var i=wi(n,"base",yi);return(i?c(i.value,t):t)||null},p=function(n,t){wf(n,!1,function(n){return n.nodeType===1&&t(n),!0})},os=function(n,t,i){for(var u=i.split("/"),r=0,f=u.length;r<f;r++)n=n&&b(n,t,u[r]);return n||null},iw=function(n,t,i){var f=i.lastIndexOf("/"),r=i.substring(f+1),e=i.substring(0,f),u=e?os(n,t,e):n;return u?r.charAt(0)==="@"?wi(u,r.substring(1),t):b(u,t,r):null},b=function(n,t,i){return ss(n,t,i,!1)},rw=function(n,t,i){if(n.getElementsByTagNameNS){var r=n.getElementsByTagNameNS(t,i);return r.length>0?r[0]:null}return ss(n,t,i,!0)},ss=function(n,t,i,r){var e=null;return wf(n,r,function(n){if(n.nodeType===1){var r=!t||u(n)===t,o=!i||f(n)===i;r&&o&&(e=n)}return e===null}),e},k=function(n){var i=null,r=n.nodeType===9&&n.documentElement?n.documentElement:n,f=r.ownerDocument.preserveWhiteSpace===!1,u;return wf(r,!1,function(n){if(n.nodeType===3||n.nodeType===4){var e=bi(n),o=f||!bp(e);o||(u===t&&(u=kp(r)),o=u);o&&(i?i+=e:i=e)}return!0}),i},f=function(n){return n.localName||n.baseName},u=function(n){return n.namespaceURI||null},bi=function(n){return n.nodeType===1?k(n):n.nodeValue},wf=function(n,t,i){for(var f=[],r=n.firstChild,u=!0;r&&u;)u=i(r),u&&(t&&r.firstChild&&f.push(r.firstChild),r=r.nextSibling||f.shift())},uw=function(n,t,i){for(var r=n.nextSibling,e,o;r;){if(r.nodeType===1&&(e=!t||u(r)===t,o=!i||f(r)===i,e&&o))return r;r=r.nextSibling}return null},hs=function(){var t=n.document.implementation;return t&&t.createDocument?t.createDocument(null,null,null):es()},hu=function(n,t){if(!e(t))return l(n,t);for(var i=0,r=t.length;i<r;i++)t[i]&&l(n,t[i]);return n},l=function(n,t){if(t){if(typeof t=="string")return tw(n,ew(n.ownerDocument,t));t.nodeType===2?n.setAttributeNodeNS?n.setAttributeNodeNS(t):n.setAttributeNode(t):n.appendChild(t)}return n},oi=function(n,i,r,u){var f=n.createAttributeNS&&n.createAttributeNS(i,r)||n.createNode(2,r,i||t);return f.value=u||"",f},ar=function(n,i,r,u){var f=n.createElementNS&&n.createElementNS(i,r)||n.createNode(1,r,i||t);return hu(f,u||[])},cs=function(n,t,i){return oi(n,cr,yt("xmlns",i),t)},fw=function(n,t){for(var f="<c>"+t+"<\/c>",e=su(f),r=e.documentElement,o=("importNode"in n)?n.importNode(r,!0):r,u=n.createDocumentFragment(),i=o.firstChild;i;)u.appendChild(i),i=i.nextSibling;return u},ew=function(n,t){return n.createTextNode(t)},ow=function(n,t,i,r,u){for(var f="",h=u.split("/"),c=b,a=ar,o=t,e,s=0,v=h.length;s<v;s++)f=h[s],f.charAt(0)==="@"&&(f=f.substring(1),c=wi,a=oi),e=c(o,i,f),e||(e=a(n,i,yt(r,f)),l(o,e)),o=e;return o},bf=function(t){var i=n.XMLSerializer,r;if(i)return r=new i,r.serializeToString(t);if(t.xml)return t.xml;throw{message:"XML serialization unsupported"};},sw=function(n){var f=n.childNodes,t,r=f.length,i;if(r===0)return"";var e=n.ownerDocument,o=e.createDocumentFragment(),u=e.createElement("c");for(o.appendChild(u),t=0;t<r;t++)u.appendChild(f[t]);for(i=bf(o),i=i.substr(3,i.length-7),t=0;t<r;t++)n.appendChild(u.childNodes[t]);return i},dit=function(i){var r=i.xml,u;if(r!==t)return r;if(n.XMLSerializer)return u=new n.XMLSerializer,u.serializeToString(i);throw{message:"XML serialization unsupported"};},hw=function(n,t,i){return function(){return n[t].apply(n,arguments),i}},ki=function(){this._arguments=t;this._done=t;this._fail=t;this._resolved=!1;this._rejected=!1};ki.prototype={then:function(n,t){return n&&(this._done?this._done.push(n):this._done=[n]),t&&(this._fail?this._fail.push(t):this._fail=[t]),this._resolved?this.resolve.apply(this,this._arguments):this._rejected&&this.reject.apply(this,this._arguments),this},resolve:function(){if(this._done){for(var n=0,i=this._done.length;n<i;n++)this._done[n].apply(null,arguments);this._done=t;this._resolved=!1;this._arguments=t}else this._resolved=!0,this._arguments=arguments},reject:function(){if(this._fail){for(var n=0,i=this._fail.length;n<i;n++)this._fail[n].apply(null,arguments);this._fail=t;this._rejected=!1;this._arguments=t}else this._rejected=!0,this._arguments=arguments},promise:function(){var n={};return n.then=hw(this,"then",n),n}};var cu=function(){return n.jQuery&&n.jQuery.Deferred?new n.jQuery.Deferred:new ki},ls=function(n,t){var i=(n&&n.__metadata||{}).type;return i||(t?t.type:null)},y="Edm.",as=y+"Binary",vs=y+"Boolean",ys=y+"Byte",lu=y+"DateTime",au=y+"DateTimeOffset",ps=y+"Decimal",ws=y+"Double",bs=y+"Guid",ks=y+"Int16",ds=y+"Int32",gs=y+"Int64",nh=y+"SByte",th=y+"Single",vr=y+"String",vu=y+"Time",st=y+"Geography",ih=st+"Point",rh=st+"LineString",uh=st+"Polygon",fh=st+"Collection",eh=st+"MultiPolygon",oh=st+"MultiLineString",sh=st+"MultiPoint",ft=y+"Geometry",hh=ft+"Point",ch=ft+"LineString",lh=ft+"Polygon",ah=ft+"Collection",vh=ft+"MultiPolygon",yh=ft+"MultiLineString",ph=ft+"MultiPoint",kf="Point",df="LineString",gf="Polygon",ne="MultiPoint",te="MultiLineString",ie="MultiPolygon",re="GeometryCollection",cw=[vr,ds,gs,vs,ws,th,lu,au,vu,ps,bs,ys,ks,nh,as],lw=[ft,hh,ch,lh,ah,vh,yh,ph],aw=[st,ih,rh,uh,fh,eh,oh,sh],si=function(n,t){if(!n)return null;if(e(n)){for(var r,i=0,u=n.length;i<u;i++)if(r=si(n[i],t),r)return r;return null}return n.dataServices?si(n.dataServices.schema,t):t(n)},wh=function(n,t){return n=n===0?"":"."+a(n.toString(),3),t>0&&(n===""&&(n=".000"),n+=a(t.toString(),4)),n},bh=function(n){var u,t,e;if(typeof n=="string")return n;if(u=ww(n),t=dh(n.__offset),u&&t!=="Z"){n=new Date(n.valueOf());var i=hc(t),o=n.getUTCHours()+i.d*i.h,s=n.getUTCMinutes()+i.d*i.m;n.setUTCHours(o,s)}else u||(t="");var r=n.getUTCFullYear(),h=n.getUTCMonth()+1,f="";return r<=0&&(r=-(r-1),f="-"),e=wh(n.getUTCMilliseconds(),n.__ns),f+a(r,4)+"-"+a(h,2)+"-"+a(n.getUTCDate(),2)+"T"+a(n.getUTCHours(),2)+":"+a(n.getUTCMinutes(),2)+":"+a(n.getUTCSeconds(),2)+e+t},kh=function(n){var t=n.ms,e="",i,r,u,f;return t<0&&(e="-",t=-t),i=Math.floor(t/864e5),t-=864e5*i,r=Math.floor(t/36e5),t-=36e5*r,u=Math.floor(t/6e4),t-=6e4*u,f=Math.floor(t/1e3),t-=f*1e3,e+"P"+a(i,2)+"DT"+a(r,2)+"H"+a(u,2)+"M"+a(f,2)+wh(t,n.ns)+"S"},a=function(n,t,i){for(var r=n.toString(10);r.length<t;)i?r+="0":r="0"+r;return r},dh=function(n){return!n||n==="Z"||n==="+00:00"||n==="-00:00"?"Z":n},yu=function(n){if(typeof n=="string"){var t=n.indexOf(")",10);if(n.indexOf("Collection(")===0&&t>0)return n.substring(11,t)}return null},vw=function(n,i,r,u,f,e){return f.request(n,function(f){try{f.headers&&se(f.headers);f.data===t&&f.statusCode!==204&&u.read(f,e)}catch(o){o.request===t&&(o.request=n);o.response===t&&(o.response=f);r(o);return}i(f.data,f)},r)},yw=function(n){return d(n)&&e(n.__batchRequests)},pw=/Collection\((.*)\)/,gh=function(n,t){var i=n&&n.results||n;return!!i&&pu(t)||!t&&e(i)&&!d(i[0])},pu=function(n){return pw.test(n)},d=function(n){return!!n&&vf(n)&&!e(n)&&!af(n)},ww=function(n){return n.__edmType==="Edm.DateTimeOffset"||!n.__edmType&&n.__offset},nc=function(n){if(!n&&!d(n))return!1;var t=n.__metadata||{},i=n.__deferred||{};return!t.type&&!!i.uri},tc=function(n){return d(n)&&n.__metadata&&"uri"in n.__metadata},yr=function(n,t){var i=n&&n.results||n;return e(i)&&!pu(t)&&d(i[0])},ue=function(n){return or(aw,n)},fe=function(n){return or(lw,n)},ic=function(n){if(!n&&!d(n))return!1;var i=n.__metadata,t=n.__mediaresource;return!i&&!!t&&!!t.media_src},wu=function(n){return af(n)||typeof n=="string"||typeof n=="number"||typeof n=="boolean"},ee=function(n){return or(cw,n)},rc=function(n,i){return nc(n)?"deferred":tc(n)?"entry":yr(n)?"feed":i&&i.relationship?n===null||n===t||!yr(n)?"entry":"feed":null},pt=function(n,t){return sr(n,function(n){return n.name===t})},oe=function(n,t,i){return n?si(t,function(t){return tb(n,t,i)}):null},bw=function(n,t){return sr(n,function(n){return n.name===t})},di=function(n,t){return oe(n,t,"complexType")},wt=function(n,t){return oe(n,t,"entityType")},uc=function(n){return si(n,function(n){return sr(n.entityContainer,function(n){return he(n.isDefaultEntityContainer)})})},fc=function(n,t){return oe(n,t,"entityContainer")},kw=function(n,t){return sr(n,function(n){return n.name===t})},dw=function(n,t){var u=null,f,i,r;return n&&(f=n.relationship,i=si(t,function(n){var r=ec(n.namespace,f),i=n.association,t,u;if(r&&i)for(t=0,u=i.length;t<u;t++)if(i[t].name===r)return i[t];return null}),i&&(r=i.end[0],r.role!==n.toRole&&(r=i.end[1]),u=r.type)),u},gw=function(n,t,i){if(n){var u=n.relationship,r=si(i,function(n){for(var t,i,f=n.entityContainer,r=0;r<f.length;r++)if(t=f[r].associationSet,t)for(i=0;i<t.length;i++)if(t[i].association==u)return t[i];return null});if(r&&r.end[0]&&r.end[1])return r.end[0].entitySet==t?r.end[1].entitySet:r.end[0].entitySet}return null},nb=function(n,t){return si(t,function(t){for(var r,u,f=t.entityContainer,i=0;i<f.length;i++)if(r=f[i].entitySet,r)for(u=0;u<r.length;u++)if(r[u].name==n)return{entitySet:r[u],containerName:f[i].name,functionImport:f[i].functionImport};return null})},ec=function(n,t){return t.indexOf(n)===0&&t.charAt(n.length)==="."?t.substr(n.length+1):null},tb=function(n,t,i){if(n&&t){var r=ec(t.namespace,n);if(r)return sr(t[i],function(n){return n.name===r})}return null},ht=function(n,t){var i,f,e;if(n===t)return n;var r=n.split("."),u=t.split("."),o=r.length>=u.length?r.length:u.length;for(i=0;i<o;i++){if(f=r[i]&&s(r[i]),e=u[i]&&s(u[i]),f>e)return n;if(f<e)return t}},ib={accept:"Accept","content-type":"Content-Type",dataserviceversion:"DataServiceVersion",maxdataserviceversion:"MaxDataServiceVersion"},se=function(n){var t,r,i,u;for(t in n)r=t.toLowerCase(),i=ib[r],i&&t!==i&&(u=n[t],delete n[t],n[i]=u)},he=function(n){return typeof n=="boolean"?n:typeof n=="string"&&n.toLowerCase()==="true"},rb=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?(?:\.(\d+))?(.*)$/,oc=function(n,t,i){var r=rb.exec(n),o=r?dh(r[8]):null,h,u,e,c,l,f;if(!r||!t&&o!=="Z"){if(i)return null;throw{message:"Invalid date/time value"};}if(h=s(r[1]),h<=0&&h++,u=r[7],e=0,u){if(u.length>7){if(i)return null;throw{message:"Cannot parse date/time value to given precision."};}e=a(u.substring(3),4,!0);u=a(u.substring(0,3),3,!0);u=s(u);e=s(e)}else u=0;var v=s(r[4]),y=s(r[5]),p=s(r[6])||0;if(o!=="Z"&&(c=hc(o),l=-c.d,v+=c.h*l,y+=c.m*l),f=new Date,f.setUTCFullYear(h,s(r[2])-1,s(r[3])),f.setUTCHours(v,y,p,u),isNaN(f.valueOf())){if(i)return null;throw{message:"Invalid date/time value"};}return t&&(f.__edmType="Edm.DateTimeOffset",f.__offset=o),e&&(f.__ns=e),f},bu=function(n,t){return oc(n,!1,t)},ce=function(n,t){return oc(n,!0,t)},sc=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/,git=function(n){sc.test(n)},le=function(n){var i=sc.exec(n),t,r,u;if(i===null)throw{message:"Invalid duration value."};var f=i[2]||"0",e=i[3]||"0",o=s(i[4]||0),h=s(i[5]||0),c=s(i[6]||0),l=parseFloat(i[7]||0);if(f!=="0"||e!=="0")throw{message:"Unsupported duration value."};if(t=i[8],r=0,t){if(t.length>7)throw{message:"Cannot parse duration value to given precision."};r=a(t.substring(3),4,!0);t=a(t.substring(0,3),3,!0);t=s(t);r=s(r)}else t=0;return t+=l*1e3+c*6e4+h*36e5+o*864e5,i[1]==="-"&&(t=-t),u={ms:t,__edmType:"Edm.Time"},r&&(u.ns=r),u},hc=function(n){var t=n.substring(0,1),i,r;return t=t==="+"?1:-1,i=s(n.substring(1)),r=s(n.substring(n.indexOf(":")+1)),{d:t,h:i,m:r}},cc=function(n,i,r){n.method||(n.method="GET");n.headers?se(n.headers):n.headers={};n.headers.Accept===t&&(n.headers.Accept=i.accept);et(n.data)&&n.body===t&&i.write(n,r);et(n.headers.MaxDataServiceVersion)||(n.headers.MaxDataServiceVersion=i.maxDataServiceVersion||"1.0")},lc=function(n,i,r){var u,e,f;if(n&&typeof n=="object")for(u in n)e=n[u],f=lc(e,u,r),f=r(u,f,i),f!==e&&(e===t?delete n[u]:n[u]=f);return n},ub=function(n,t){return t("",lc(n,"",t))},ku=0,fb=function(n){return n.method&&n.method!=="GET"?!1:!0},eb=function(t){var i=n.document.createElement("IFRAME");i.style.display="none";var r=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;"),u='<html><head><script type="text/javascript" src="'+r+'"><\/script><\/head><body><\/body><\/html>',f=n.document.getElementsByTagName("BODY")[0];return f.appendChild(i),ac(i,u),i},ob=function(){if(n.XMLHttpRequest)return new n.XMLHttpRequest;var t;if(n.ActiveXObject)try{return new n.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(r){try{return new n.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(i){t=i}}else t={message:"XMLHttpRequest not supported"};throw t;},sb=function(n){return n.indexOf("http://")===0||n.indexOf("https://")===0||n.indexOf("file://")===0},hb=function(t){if(!sb(t))return!0;var i=n.location,r=i.protocol+"//"+i.host+"/";return t.indexOf(r)===0},cb=function(i,r){try{delete n[i]}catch(u){n[i]=t;r===ku-1&&(ku-=1)}},du=function(n){return n&&(ac(n,""),n.parentNode.removeChild(n)),null},lb=function(n,t){for(var r=n.getAllResponseHeaders().split(/\r?\n/),u,i=0,f=r.length;i<f;i++)r[i]&&(u=r[i].split(": "),t[u[0]]=u[1])},ac=function(n,t){var i=n.contentWindow?n.contentWindow.document:n.contentDocument.document;i.open();i.write(t);i.close()};r.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:!1,request:function(i,r,u){var y={},f=null,h=!1,s,a,w,b,k,d,l,v;y.abort=function(){(s=du(s),h)||(h=!0,f&&(f.abort(),f=null),u({message:"Request aborted"}))};var p=function(){s=du(s);h||(h=!0,f=null,u({message:"Request timed out"}))},c,e=i.requestUri,g=it(i.enableJsonpCallback,this.enableJsonpCallback),nt=it(i.callbackParameterName,this.callbackParameterName),tt=it(i.formatQueryString,this.formatQueryString);if(!g||hb(e)){if(f=ob(),f.onreadystatechange=function(){var t,n,o,s;h||f===null||f.readyState!==4||(t=f.statusText,n=f.status,n===1223&&(n=204,t="No Content"),o=[],lb(f,o),s={requestUri:e,statusCode:n,statusText:t,headers:o,body:f.responseText},h=!0,f=null,n>=200&&n<=299?r(s):u({message:"HTTP request failed",request:i,response:s}))},f.open(i.method||"GET",e,!0,i.user,i.password),i.headers)for(c in i.headers)f.setRequestHeader(c,i.headers[c]);i.timeoutMS&&(f.timeout=i.timeoutMS,f.ontimeout=p);i.withCredentials&&(f.withCredentials=i.withCredentials);f.send(i.body)}else{if(!fb(i))throw{message:"Request is not local and cannot be done through JSONP."};a=ku;ku+=1;w=a.toString();b=!1;c="handleJSONP_"+w;n[c]=function(i){if(s=du(s),!h){b=!0;n.clearTimeout(k);cb(c,a);n.ActiveXObject&&(i=n.JSON.parse(n.JSON.stringify(i)));var u;u=i.d===t?{"Content-Type":"application/json;odata=minimalmetadata",dataServiceVersion:"3.0"}:{"Content-Type":"application/json"};o(function(){du(s);r({body:i,statusCode:200,headers:u})})}};d=i.timeoutMS?i.timeoutMS:12e4;k=n.setTimeout(p,d);l=nt+"=parent."+c;this.formatQueryString&&(l+="&"+tt);v=e.indexOf("?");e=v===-1?e+"?"+l:v===e.length-1?e+l:e+"&"+l;s=eb(e)}return y}};var hi="3.0",gi=function(n){var t,r,i,f,u;if(!n)return null;for(t=n.split(";"),r={},i=1,f=t.length;i<f;i++)u=t[i].split("="),r[ts(u[0])]=u[1];return{mediaType:ts(t[0]),properties:r}},ab=function(n){if(!n)return t;var i=n.mediaType;for(var r in n.properties)i+=";"+r+"="+n.properties[r];return i},vc=function(n,t,i,r){var u={};return g(u,i),g(u,{contentType:n,dataServiceVersion:t,handler:r}),u},yc=function(n,t,i){if(n){var r=n.headers;r[t]||(r[t]=i)}},vb=function(n,t){if(n){var i=n.headers,r=i.DataServiceVersion;i.DataServiceVersion=r?ht(r,t):t}},pc=function(n,i){var r=n.headers;return r&&r[i]||t},wc=function(n){return gi(pc(n,"Content-Type"))},yb=/^\s?(\d+\.\d+);?.*$/,bc=function(n){var i=pc(n,"DataServiceVersion"),t;if(i&&(t=yb.exec(i),t&&t.length))return t[1]},kc=function(n,t){return n.accept.indexOf(t.mediaType)>=0},pb=function(n,i,r,u){var f;if(!r||!r.headers)return!1;var e=wc(r),s=bc(r)||"",o=r.body;return et(o)?kc(n,e)?(f=vc(e,s,u,n),f.response=r,r.data=i(n,o,f),r.data!==t):!1:!1},wb=function(n,i,r,u){var e,o,f;return!r||!r.headers?!1:(e=wc(r),o=bc(r),(!e||kc(n,e))&&(f=vc(e,o,u,n),f.request=r,r.body=i(n,r.data,f),r.body!==t))?(vb(r,f.dataServiceVersion||"1.0"),yc(r,"Content-Type",ab(f.contentType)),yc(r,"MaxDataServiceVersion",n.maxDataServiceVersion),!0):!1},ci=function(n,t,i,r){return{accept:i,maxDataServiceVersion:r,read:function(t,i){return pb(this,n,t,i)},write:function(n,i){return wb(this,t,n,i)}}},bb=function(n,t){return t},kb=function(n,i){return et(i)?i.toString():t};r.textHandler=ci(bb,kb,"text/plain",hi);var dc=eu+"www.opengis.net",ut=dc+"/gml",gc=dc+"/def/crs/EPSG/0/",nl="gml",pr=function(n,t,i){var r={type:n};return r[t]=i,r},ae=function(n){if(e(n)&&n.length>=2){var t=n[0];n[0]=n[1];n[1]=t}return n},ve=function(n,t,i,r,u,f){var e=tl(n,i,r,u,f);return pr(t,"coordinates",e)},tl=function(n,t,i,r,e){var o=[];return p(n,function(n){var s,h,c;if(u(n)===ut){if(s=f(n),s===t){h=b(n,ut);h&&(c=r(h,e),c&&o.push(c));return}s===i&&p(n,function(n){if(u(n)===ut){var t=r(n,e);t&&o.push(t)}})}}),o},db=function(n,t){var i=tl(n,"geometryMember","geometryMembers",ul,t);return pr(re,"geometries",i)},gb=function(n,t){return pr(df,"coordinates",ye(n,t))},nk=function(n,t){return ve(n,te,"curveMember","curveMembers",ye,t)},tk=function(n,t){return ve(n,ne,"pointMember","pointMembers",pe,t)},ik=function(n,t){return ve(n,ie,"surfaceMember","surfaceMembers",il,t)},rk=function(n,t){return pr(kf,"coordinates",pe(n,t))},uk=function(n,t){return pr(gf,"coordinates",il(n,t))},ye=function(n,t){var i=[];return p(n,function(n){var e=u(n),r;if(e===ut){if(r=f(n),r==="posList"){i=ek(n,t);return}if(r==="pointProperty"){i.push(fk(n,t));return}if(r==="pos"){i.push(we(n,t));return}}}),i},pe=function(n,t){var i=b(n,ut,"pos");return i?we(i,t):[]},fk=function(n,t){var i=b(n,ut,"Point");return i?pe(i,t):[]},il=function(n,t){var i=[],r=!1;return p(n,function(n){if(u(n)===ut){var e=f(n);if(e==="exterior"){r=!0;i.unshift(rl(n,t));return}if(e==="interior"){i.push(rl(n,t));return}}}),!r&&i.length>0&&i.unshift([[]]),i},rl=function(n,t){var i=[];return p(n,function(n){u(n)===ut&&f(n)==="LinearRing"&&(i=ye(n,t))}),i},ek=function(n,t){var f=we(n,!1),e=f.length,r,i,u;if(e%2!=0)throw{message:"GML posList element has an uneven number of numeric values"};for(r=[],i=0;i<e;i+=2)u=f.slice(i,i+2),r.push(t?ae(u):u);return r},we=function(n,t){var u=[],r=k(n),f;if(r)for(var o=r.length,e=0,i=0;i<=o;)" \t\r\n".indexOf(r.charAt(i))!==-1&&(f=r.substring(e,i),f&&u.push(parseFloat(f)),e=i+1),i++;return t?ae(u):u},ul=function(n,t){var o=f(n),i,u,r,e;switch(o){case"Point":i=rk;break;case"Polygon":i=uk;break;case"LineString":i=gb;break;case"MultiPoint":i=tk;break;case"MultiCurve":i=nk;break;case"MultiSurface":i=ik;break;case"MultiGeometry":i=db;break;default:throw{message:"Unsupported element: "+o,element:n};}if(u=i(n,t),r=ot(n,"srsName",ut)||ot(n,"srsName"),r){if(r.indexOf(gc)!==0)throw{message:"Unsupported srs name: "+r,element:n};e=r.substring(gc.length);e&&(u.crs={type:"name",properties:{name:"EPSG:"+e}})}return u},fl=function(n,t,i,r){var u,o,e,s,f,h,c;switch(i){case kf:u=ok;break;case df:u=sk;break;case gf:u=hk;break;case ne:u=ck;break;case te:u=lk;break;case ie:u=ak;break;case re:u=yk;break;default:return null}return o=u(n,t,r),e=t.crs,e&&e.type==="name"&&(s=e.properties,f=s&&s.name,f&&f.indexOf("ESPG:")===0&&f.length>5&&(h=f.substring(5),c=oi(n,null,"srsName",nl+h),l(o,c))),o},bt=function(n,t,i){return ar(n,ut,yt(nl,t),i)},el=function(n,t,i){var r=e(t)?t:[];return r=i?ae(r):r,bt(n,"pos",r.join(" "))},ol=function(n,t,i,r){var f=bt(n,t),u,o;if(e(i)){for(u=0,o=i.length;u<o;u++)l(f,el(n,i[u],r));o===0&&l(f,bt(n,"posList"))}return f},sl=function(n,t,i){return bt(n,"Point",el(n,t,i))},hl=function(n,t,i){return ol(n,"LineString",t,i)},cl=function(n,t,i,r){var u=bt(n,t),f;return e(i)&&i.length>0&&(f=ol(n,"LinearRing",i,r),l(u,f)),u},ll=function(n,t,i){var f=t&&t.length,u=bt(n,"Polygon"),r;if(e(t)&&f>0)for(l(u,cl(n,"exterior",t[0],i)),r=1;r<f;r++)l(u,cl(n,"interior",t[r],i));return u},ok=function(n,t,i){return sl(n,t.coordinates,i)},sk=function(n,t,i){return hl(n,t.coordinates,i)},hk=function(n,t,i){return ll(n,t.coordinates,i)},gu=function(n,t,i,r,u,f){var h=r&&r.length,c=bt(n,t),s,o;if(e(r)&&h>0){for(s=bt(n,i),o=0;o<h;o++)l(s,u(n,r[o],f));l(c,s)}return c},ck=function(n,t,i){return gu(n,"MultiPoint","pointMembers",t.coordinates,sl,i)},lk=function(n,t,i){return gu(n,"MultiCurve","curveMembers",t.coordinates,hl,i)},ak=function(n,t,i){return gu(n,"MultiSurface","surfaceMembers",t.coordinates,ll,i)},vk=function(n,t,i){return fl(n,t,t.type,i)},yk=function(n,t,i){return gu(n,"MultiGeometry","geometryMembers",t.geometries,vk,i)},nf="application/xml",kt=eu+"schemas.microsoft.com/ado/",li=kt+"2007/08/dataservices",tf=kt+"2007/06/edmx",pk=kt+"2006/04/edm",wk=kt+"2007/05/edm",bk=kt+"2008/01/edm",kk=kt+"2008/09/edm",dk=kt+"2009/08/edm",gk=kt+"2009/11/edm",ct=li,nt=li+"/metadata",be=li+"/related/",al=li+"/scheme",vl="d",ke="m",dt=function(n,t){var i={name:f(n),value:n.value};return i[t?"namespaceURI":"namespace"]=u(n),i},wr=function(n,t){for(var s=[],h=[],l=n.attributes,e,i,o,r=0,c=l.length;r<c;r++)e=l[r],u(e)!==cr&&s.push(dt(e,t));for(i=n.firstChild;i!=null;)i.nodeType===1&&h.push(wr(i,t)),i=i.nextSibling;return o={name:f(n),value:k(n),attributes:s,children:h},o[t?"namespaceURI":"namespace"]=u(n),o},de=function(n){return u(n)===ct&&f(n)==="element"},yl=function(n,t){return{type:n,extensions:t}},nd=function(n){var t,i;return b(n,ut)?ft:(t=b(n,ct),!t)?vr:de(t)&&(i=uw(t,ct),i&&de(i))?"Collection()":null},pl=function(n){var t=null,i=!1,r=[];return pi(n,function(n){var e=u(n),o=f(n),s=bi(n);if(e===nt){if(o==="null"){i=s.toLowerCase()==="true";return}if(o==="type"){t=s;return}}if(e!==yi&&e!==cr){r.push(dt(n,!0));return}}),{type:!t&&i?vr:t,isNull:i,extensions:r}},wl=function(n){if(u(n)!==ct)return null;var e=f(n),t=pl(n),o=t.isNull,i=t.type,r=yl(i,t.extensions),s=o?null:bl(n,i,r);return{name:e,value:s,metadata:r}},bl=function(n,t,i){t||(t=nd(n),i.type=t);var r=ue(t);return r||fe(t)?td(n,t,r):ee(t)?kl(n,t):pu(t)?rd(n,t,i):id(n,t,i)},td=function(n,t,i){var u=b(n,ut),r=ul(u,i);return r.__metadata={type:t},r},kl=function(n,t){var i=bi(n)||"";switch(t){case vs:return he(i);case as:case ps:case bs:case gs:case vr:return i;case ys:case ks:case ds:case nh:return s(i);case ws:case th:return parseFloat(i);case vu:return le(i);case lu:return bu(i);case au:return ce(i)}return i},id=function(n,t,i){var r={__metadata:{type:t}};return p(n,function(n){var t=wl(n),u=t.name;i.properties=i.properties||{};i.properties[u]=t.metadata;r[u]=t.value}),r},rd=function(n,t,i){var r=[],u=i.elements=[],f=yu(t);return p(n,function(n){if(de(n)){var t=pl(n),o=t.extensions,i=t.type||f,e=yl(i,o),s=bl(n,i,e);r.push(s);u.push(e)}}),{__metadata:{type:t==="Collection()"?null:t},results:r}},ud=function(n,i){if(u(n)===ct){i=rt(n,i);var r=f(n);if(r==="links")return fd(n,i);if(r==="uri")return dl(n,i)}return t},fd=function(n,t){var i=[];return p(n,function(n){f(n)==="uri"&&u(n)===ct&&i.push(dl(n,t))}),{results:i}},dl=function(n,t){var i=k(n)||"";return{uri:c(i,t)}},ed=function(n,t){return t===ft||t===st?n&&n.type:t===hh||t===ih?kf:t===ch||t===rh?df:t===lh||t===uh?gf:t===ah||t===fh?re:t===vh||t===eh?ie:t===yh||t===oh?te:t===ph||t===sh?ne:null},gl=function(n,t,i){return ar(n,nt,yt(ke,t),i)},ge=function(n,t,i){return oi(n,nt,yt(ke,t),i)},na=function(n,t,i){return ar(n,ct,yt(vl,t),i)},od=function(n,t){return t===lu||t===au||af(n)?bh(n):t===vu?kh(n):n.toString()},lt=function(n,t){return{element:n,dsv:t}},br=function(n,t,i,r){var u=i?ge(n,"type",i):null,f=na(n,t,u);return hu(f,r)},sd=function(n,t,i,r){var u=od(i,r),f=br(n,t,r,u);return lt(f,"1.0")},hd=function(n,t,i,r){var u=ge(n,"null","true"),f=br(n,t,i,u),e=di(i,r)?"2.0":"1.0";return lt(f,e)},cd=function(n,t,i,r,u,f,o){var c=yu(r),a=e(i)?i:i.results,v=r?{type:c}:{},h,s,y,p,w;for(v.properties=u.properties,h=br(n,t,c?r:null),s=0,y=a.length;s<y;s++)p=a[s],w=no(n,"element",p,v,f,o),l(h,w.element);return lt(h,"3.0")},ld=function(n,t,i,r,u,f,e){var h=br(n,t,r),a=u.properties||{},v=di(r,e)||{},s="1.0";for(var o in i)if(o!=="__metadata"){var y=i[o],p=pt(v.property,o),w=a[o]||{},c=no(n,o,y,w,p,e);s=ht(s,c.dsv);l(h,c.element)}return lt(h,s)},ad=function(n,t,i,r,u){var f=ed(i,r),e=fl(n,i,f,u),o=br(n,t,r,e);return lt(o,"3.0")},no=function(n,t,i,r,u,f){var e=ls(i,r,u),o,s;return wu(i)?sd(n,t,i,e||vr):(o=ue(e),o||fe(e))?ad(n,t,i,e,o):gh(i,e)?cd(n,t,i,e,r,u,f):ic(i)?null:(s=rc(i,u),s!==null)?null:i===null?hd(n,t,e):ld(n,t,i,e,r,u,f)},vd=function(n){if(n&&vf(n)){var t=hs();return l(t,na(t,"uri",n.uri))}},yd=function(n,t){if(t){var r=su(t),i=b(r);if(i)return ud(i)}},pd=function(n,i,r){var u=r.contentType=r.contentType||gi(nf);return u&&u.mediaType===nf?bf(vd(i)):t};r.xmlHandler=ci(yd,pd,nf,hi);var ta="a",gt=hr+"2005/Atom",kr=hr+"2007/app",ia=li+"/edit-media/",ra=li+"/mediaresource/",ua=li+"/relatedlinks/",fa=["application/atom+xml","application/atomsvc+xml","application/xml"],ea=fa[0],wd=[gt,kr,yi,cr],bd={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},kd=function(n){return bd[n]||n},dr=function(n){return!or(wd,n)},oa=function(n,t,i,r,u){var f;if(u=u||"",f=n["FC_TargetPath"+u],!f)return null;var e=n["FC_SourcePath"+u],s=kd(f),o=r?r+(e?"/"+e:""):e,l=o&&rg(i,t,o),h=n["FC_NsUri"+u]||null,c=n["FC_NsPrefix"+u]||null,a=n["FC_KeepInContent"+u]||"";return f!==s&&(h=gt,c=ta),{contentKind:n["FC_ContentKind"+u],keepInContent:a.toLowerCase()==="true",nsPrefix:c,nsURI:h,propertyPath:o,propertyType:l,entryPath:s}},sa=function(n,t,i){for(var c,r,f,u,e;n;){for(c=n.FC_SourcePath,r=oa(n,n,t),r&&i(r),f=n.property||[],u=0,e=f.length;u<e;u++)for(var o=f[u],s=0,h="";r=oa(o,n,t,o.name,h);)i(r),s++,h="_"+s;n=wt(n.baseType,t)}return[]},rf=function(n){var t=[];return pi(n,function(n){var i=u(n);dr(i)&&t.push(dt(n,!0))}),t},ha=function(n){return wr(n,!0)},ca=function(n,t,i){var e=u(n),r=f(n);if(e===kr&&r==="service")return ag(n,t);if(e===gt){if(r==="feed")return dd(n,t,i);if(r==="entry")return pa(n,t,i)}},la=function(n,t){var r=[],i={extensions:r};return pi(n,function(e){var o=f(e),s=u(e),h=bi(e);if(s===null){if(o==="title"||o==="metadata"){i[o]=h;return}if(o==="target"){i.target=c(h,rt(n,t));return}}dr(s)&&r.push(dt(e,!0))}),i},aa=function(n,t,i){var r=i.actions=i.actions||[];r.push(la(n,t))},va=function(n,t,i){var r=i.functions=i.functions||[];r.push(la(n,t))},dd=function(n,t,i){var o=rf(n),r={feed_extensions:o},s=[],e={__metadata:r,results:s};return t=rt(n,t),p(n,function(n){var l=u(n),h=f(n);if(l===nt){if(h==="count"){e.__count=parseInt(k(n),10);return}if(h==="action"){aa(n,t,r);return}if(h==="function"){va(n,t,r);return}}if(dr(l)){o.push(wr(n));return}if(h==="entry"){s.push(pa(n,t,i));return}if(h==="link"){gd(n,e,t);return}if(h==="id"){r.uri=c(k(n),t);r.uri_extensions=rf(n);return}if(h==="title"){r.title=k(n)||"";r.title_extensions=rf(n);return}}),e},gd=function(n,t,i){var r=ya(n,i),f=r.href,e=r.rel,o=r.extensions,u=t.__metadata;if(e==="next"){t.__next=f;u.next_extensions=o;return}if(e==="self"){u.self=f;u.self_extensions=o;return}},ya=function(n,t){t=rt(n,t);var r=[],i={extensions:r,baseURI:t};if(pi(n,function(n){var s=u(n),e=f(n),o=n.value;if(e==="href"){i.href=c(o,t);return}if(e==="type"||e==="rel"){i[e]=o;return}dr(s)&&r.push(dt(n,!0))}),!i.href)throw{error:"href attribute missing on link element",element:n};return i},ng=function(n,i){if(n.indexOf("/")===-1)return i[n];for(var u=n.split("/"),r=0,f=u.length;r<f;r++){if(i===null)return t;if(i=i[u[r]],i===t)return i}return i},tg=function(n,i,r,u){var o,s,f,h,e;if(n.indexOf("/")===-1)i[n]=r,o=n;else{for(s=n.split("/"),f=0,h=s.length-1;f<h;f++){if(e=i[s[f]],e===t)e={},i[s[f]]=e;else if(e===null)return;i=e}o=s[f];i[o]=r}if(u){var c=i.__metadata=i.__metadata||{},l=c.properties=c.properties||{},a=l[o]=l[o]||{};a.type=u}},ig=function(n,t,i){var f=n.propertyPath,r,u,e;n.keepInContent||ng(f,i)===null||(r=iw(t,n.nsURI,n.entryPath),r)&&(u=n.propertyType,e=n.contentKind==="xhtml"?sw(r):kl(r,u||"Edm.String"),tg(f,i,e,u))},rg=function(n,t,i){for(var s=i.split("/"),u,h,f,e,o,r;t;){for(f=t,u=0,h=s.length;u<h;u++){if(e=f.property,!e)break;if(o=pt(e,s[u]),!o)break;if(r=o.type,!r||ee(r))return r||null;if(f=di(r,n),!f)return null}t=wt(t.baseType,n)}return null},pa=function(n,t,i){var r={},e={__metadata:r},o=ot(n,"etag",nt),s;return o&&(r.etag=o),t=rt(n,t),p(n,function(n){var s=u(n),o=f(n);if(s===gt){if(o==="id"){ug(n,r,t);return}if(o==="category"){fg(n,r);return}if(o==="content"){eg(n,e,r,t);return}if(o==="link"){og(n,e,r,t,i);return}return}if(s===nt){if(o==="properties"){ka(n,e,r);return}if(o==="action"){aa(n,t,r);return}if(o==="function"){va(n,t,r);return}}}),s=wt(r.type,i),sa(s,i,function(t){ig(t,n,e)}),e},ug=function(n,t,i){t.uri=c(k(n),rt(n,i));t.uri_extensions=rf(n)},fg=function(n,t){if(ot(n,"scheme")===al){if(t.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:n};var i=[];pi(n,function(n){var t=u(n),r=f(n);if(!t){r!=="scheme"&&r!=="term"&&i.push(dt(n,!0));return}dr(t)&&i.push(dt(n,!0))});t.type=ot(n,"term");t.type_extensions=i}},eg=function(n,t,i,r){var e=ot(n,"src"),o=ot(n,"type");if(e){if(!o)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:n};i.media_src=c(e,rt(n,r));i.content_type=o}p(n,function(r){if(e)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:n};u(r)===nt&&f(r)==="properties"&&ka(r,t,i)})},og=function(n,t,i,r,u){var f=ya(n,r),e=f.rel,s=f.href,o=f.extensions;if(e==="self"){i.self=s;i.self_link_extensions=o;return}if(e==="edit"){i.edit=s;i.edit_link_extensions=o;return}if(e==="edit-media"){i.edit_media=f.href;i.edit_media_extensions=o;ba(f,i);return}if(e.indexOf(ia)===0){cg(f,t,i);return}if(e.indexOf(ra)===0){lg(f,t,i);return}if(e.indexOf(be)===0){hg(n,f,t,i,u);return}if(e.indexOf(ua)===0){sg(f,i);return}},sg=function(n,t){var r=n.rel.substring(ua.length),i;t.properties=t.properties||{};i=t.properties[r]=t.properties[r]||{};i.associationuri=n.href;i.associationuri_extensions=n.extensions},hg=function(n,t,i,r,u){var e,o=b(n,nt,"inline"),s,h,f,c;o?(s=b(o),h=rt(o,t.baseURI),e=s?ca(s,h,u):null):e={__deferred:{uri:t.href}};f=t.rel.substring(be.length);i[f]=e;r.properties=r.properties||{};c=r.properties[f]=r.properties[f]||{};c.extensions=t.extensions},cg=function(n,t,i){var o=n.rel.substring(ia.length),f=wa(o,t,i),r=f.value,u=f.metadata,e=n.href;r.edit_media=e;r.content_type=n.type;u.edit_media_extensions=n.extensions;r.media_src=r.media_src||e;u.media_src_extensions=u.media_src_extensions||[];ba(n,r)},lg=function(n,t,i){var f=n.rel.substring(ra.length),r=wa(f,t,i),u=r.value,e=r.metadata;u.media_src=n.href;e.media_src_extensions=n.extensions;u.content_type=n.type},wa=function(n,t,i){i.properties=i.properties||{};var u=i.properties[n],r=t[n]&&t[n].__mediaresource;return r||(r={},t[n]={__mediaresource:r},i.properties[n]=u={}),{value:r,metadata:u}},ba=function(n,t){for(var r=n.extensions,i=0,u=r.length;i<u;i++)if(r[i].namespaceURI===nt&&r[i].name==="etag"){t.media_etag=r[i].value;r.splice(i,1);return}},ka=function(n,t,i){p(n,function(n){var r=wl(n),u,f;r&&(u=r.name,f=i.properties=i.properties||{},f[u]=r.metadata,t[u]=r.value)})},ag=function(n,t){var i=[],r=[];if(t=rt(n,t),p(n,function(n){if(u(n)===kr&&f(n)==="workspace"){i.push(vg(n,t));return}r.push(wr(n))}),i.length===0)throw{message:"Invalid AtomPub service document: No workspace element found.",element:n};return{workspaces:i,extensions:r}},vg=function(n,i){var e=[],o=[],r;return i=rt(n,i),p(n,function(n){var s=u(n),h=f(n);if(s===gt&&h==="title"){if(r!==t)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:n};r=k(n);return}if(s===kr){h==="collection"&&e.push(yg(n,i));return}o.push(ha(n))}),{title:r||"",collections:e,extensions:o}},yg=function(n,i){var r=ot(n,"href"),o,e;if(!r)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:n};if(i=rt(n,i),r=c(r,rt(n,i)),o=[],p(n,function(i){var r=u(i),s=f(i);if(r===gt){if(s==="title"){if(e!==t)throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:i};e=k(i)}return}r!==kr&&o.push(ha(n))}),!e)throw{message:"Invalid AtomPub service document: collection has no title element",element:n};return{title:e,href:r,extensions:o}},ni=function(n,t,i){return ar(n,gt,yt(ta,t),i)},nr=function(n,t,i){return oi(n,null,t,i)},pg=function(n){var t,e,i,o,r;if(n.childNodes.length>0)return!1;for(t=!0,e=n.attributes,i=0,o=e.length;i<o&&t;i++)r=e[i],t=t&&dp(r)||u(r)==nt&&f(r)==="type";return t},wg=function(n,t,i,r,u){var s=null,e=null,f=null,o="",h;return i!=="deferred"?(s=nr(n,"type","application/atom+xml;type="+i),e=gl(n,"inline"),r&&(o=r.__metadata&&r.__metadata.uri||"",f=da(n,r,u)||to(n,r,u),l(e,f.element))):o=r.__deferred.uri,h=ni(n,"link",[nr(n,"href",o),nr(n,"rel",c(t,be)),s,e]),lt(h,f?f.dsv:"1.0")},bg=function(n,t,i,r,u,f){var e,o;return ic(i)?null:(e=no(n,t,i,r,u,f),e||(o=rc(i,u),e=wg(n,t,o,i,f)),e)},kg=function(n,t,i,r){var u=os(i,ct,r.propertyPath),l=u&&wi(u,"null",nt),o,s="1.0",f,e,h,c;if(l&&l.value==="true")return s;if(u&&(o=k(u)||"",!r.keepInContent))for(s="2.0",f=u.parentNode,e=f,f.removeChild(u);e!==i&&pg(e);)f=e.parentNode,f.removeChild(e),e=f;return(h=ow(n,t,r.nsURI,r.nsPrefix,r.entryPath),h.nodeType===2)?(h.value=o,s):(c=r.contentKind,hu(h,[c&&oi(n,null,"type",c),c==="xhtml"?fw(n,o):o]),s)},to=function(n,t,i){var e=t.__metadata||{},b=e.properties||{},y=e.etag,p=e.uri,s=e.type,o=wt(s,i),h=gl(n,"properties"),c=ni(n,"entry",[ni(n,"author",ni(n,"name")),y&&ge(n,"etag",y),p&&ni(n,"id",p),s&&ni(n,"category",[nr(n,"term",s),nr(n,"scheme",al)]),ni(n,"content",[nr(n,"type","application/xml"),h])]),f="1.0",r,v,w;for(r in t)if(r!=="__metadata"){var k=b[r]||{},d=o&&(pt(o.property,r)||pt(o.navigationProperty,r)),a=bg(n,r,t[r],k,d,i);a&&(v=a.element,w=u(v)===gt?c:h,l(w,v),f=ht(f,a.dsv))}return sa(o,i,function(t){var i=kg(n,c,h,t);f=ht(f,i)}),lt(c,f)},da=function(n,t,i){var f=e(t)?t:t.results,r,o,u,h,s;if(!f)return null;for(r="1.0",o=ni(n,"feed"),u=0,h=f.length;u<h;u++)s=to(n,f[u],i),l(o,s.element),r=ht(r,s.dsv);return lt(o,r)},dg=function(n,t){var u,i,r,f;return n&&(u=yr(n)&&da||vf(n)&&to,u&&(i=hs(),r=u(i,n,t),r))?(f=r.element,hu(f,[cs(i,nt,ke),cs(i,ct,vl)]),lt(l(i,f),r.dsv)):null},gg=function(n,t,i){if(t){var u=su(t),r=b(u);if(r)return ca(r,null,i.metadata)}},nn=function(n,t,i){var u=i.contentType=i.contentType||gi(ea),r;if(u&&u.mediaType===ea&&(r=dg(t,i.metadata),r))return i.dataServiceVersion=ht(i.dataServiceVersion||"1.0",r.dsv),bf(r.element)};r.atomHandler=ci(gg,nn,fa.join(","),hi);var i=function(n,t,i,r){return{attributes:n,elements:t,text:i||!1,ns:r}},tt={elements:{Annotations:i(["Target","Qualifier"],["TypeAnnotation*","ValueAnnotation*"]),Association:i(["Name"],["End*","ReferentialConstraint","TypeAnnotation*","ValueAnnotation*"]),AssociationSet:i(["Name","Association"],["End*","TypeAnnotation*","ValueAnnotation*"]),Binary:i(null,null,!0),Bool:i(null,null,!0),Collection:i(null,["String*","Int*","Float*","Decimal*","Bool*","DateTime*","DateTimeOffset*","Guid*","Binary*","Time*","Collection*","Record*"]),CollectionType:i(["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"],["CollectionType","ReferenceType","RowType","TypeRef"]),ComplexType:i(["Name","BaseType","Abstract"],["Property*","TypeAnnotation*","ValueAnnotation*"]),DateTime:i(null,null,!0),DateTimeOffset:i(null,null,!0),Decimal:i(null,null,!0),DefiningExpression:i(null,null,!0),Dependent:i(["Role"],["PropertyRef*"]),Documentation:i(null,null,!0),End:i(["Type","Role","Multiplicity","EntitySet"],["OnDelete"]),EntityContainer:i(["Name","Extends"],["EntitySet*","AssociationSet*","FunctionImport*","TypeAnnotation*","ValueAnnotation*"]),EntitySet:i(["Name","EntityType"],["TypeAnnotation*","ValueAnnotation*"]),EntityType:i(["Name","BaseType","Abstract","OpenType"],["Key","Property*","NavigationProperty*","TypeAnnotation*","ValueAnnotation*"]),EnumType:i(["Name","UnderlyingType","IsFlags"],["Member*"]),Float:i(null,null,!0),Function:i(["Name","ReturnType"],["Parameter*","DefiningExpression","ReturnType","TypeAnnotation*","ValueAnnotation*"]),FunctionImport:i(["Name","ReturnType","EntitySet","IsSideEffecting","IsComposable","IsBindable","EntitySetPath"],["Parameter*","ReturnType","TypeAnnotation*","ValueAnnotation*"]),Guid:i(null,null,!0),Int:i(null,null,!0),Key:i(null,["PropertyRef*"]),LabeledElement:i(["Name"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),Member:i(["Name","Value"]),NavigationProperty:i(["Name","Relationship","ToRole","FromRole","ContainsTarget"],["TypeAnnotation*","ValueAnnotation*"]),Null:i(null,null),OnDelete:i(["Action"]),Path:i(null,null,!0),Parameter:i(["Name","Type","Mode","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","SRID"],["CollectionType","ReferenceType","RowType","TypeRef","TypeAnnotation*","ValueAnnotation*"]),Principal:i(["Role"],["PropertyRef*"]),Property:i(["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","CollectionKind","SRID"],["CollectionType","ReferenceType","RowType","TypeAnnotation*","ValueAnnotation*"]),PropertyRef:i(["Name"]),PropertyValue:i(["Property","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ReferenceType:i(["Type"]),ReferentialConstraint:i(null,["Principal","Dependent"]),ReturnType:i(["ReturnType","Type","EntitySet"],["CollectionType","ReferenceType","RowType"]),RowType:i(["Property*"]),String:i(null,null,!0),Schema:i(["Namespace","Alias"],["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*","ValueTerm*","Annotations*"]),Time:i(null,null,!0),TypeAnnotation:i(["Term","Qualifier"],["PropertyValue*"]),TypeRef:i(["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"]),Using:i(["Namespace","Alias"]),ValueAnnotation:i(["Term","Qualifier","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ValueTerm:i(["Name","Type"],["TypeAnnotation*","ValueAnnotation*"]),Edmx:i(["Version"],["DataServices","Reference*","AnnotationsReference*"],!1,tf),DataServices:i(null,["Schema*"],!1,tf)}},ga=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];tt.elements.Property.attributes=tt.elements.Property.attributes.concat(ga);tt.elements.EntityType.attributes=tt.elements.EntityType.attributes.concat(ga);tt.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:tf};tt.elements.DataServices={elements:["Schema*"],ns:tf};tt.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer");tt.elements.Property.attributes.push("m:MimeType");tt.elements.FunctionImport.attributes.push("m:HttpMethod");tt.elements.FunctionImport.attributes.push("m:IsAlwaysBindable");tt.elements.EntityType.attributes.push("m:HasStream");tt.elements.DataServices.attributes=["m:DataServiceVersion","m:MaxDataServiceVersion"];var nv=function(n){if(!n)return n;if(n.length>1){var t=n.substr(0,2);return t===t.toUpperCase()?n:n.charAt(0).toLowerCase()+n.substr(1)}return n.charAt(0).toLowerCase()},tn=function(n,t){var r,u,e,i,f,o;if(t==="Documentation")return{isArray:!0,propertyName:"documentation"};if(r=n.elements,!r)return null;for(u=0,e=r.length;u<e;u++)if(i=r[u],f=!1,i.charAt(i.length-1)==="*"&&(f=!0,i=i.substr(0,i.length-1)),t===i)return o=nv(i),{isArray:f,propertyName:o};return null},rn=/^(m:FC_.*)_[0-9]+$/,tv=function(n){return n===pk||n===wk||n===bk||n===kk||n===dk||n===gk},io=function(n){var o=f(n),e=u(n),i=tt.elements[o];if(!i)return null;if(i.ns){if(e!==i.ns)return null}else if(!tv(e))return null;var t={},r=[],s=i.attributes||[];return pi(n,function(n){var c=f(n),e=u(n),l=n.value,i,o,h;e!==cr&&(i=null,o=!1,tv(e)||e===null?i="":e===nt&&(i="m:"),i!==null&&(i+=c,h=rn.exec(i),h&&(i=h[1]),or(s,i)&&(o=!0,t[nv(c)]=l)),o||r.push(dt(n)))}),p(n,function(n){var o=f(n),u=tn(i,o),e;u?u.isArray?(e=t[u.propertyName],e||(e=[],t[u.propertyName]=e),e.push(io(n))):t[u.propertyName]=io(n):r.push(wr(n))}),i.text&&(t.text=k(n)),r.length&&(t.extensions=r),t},iv=function(n,i){var r=su(i),u=b(r);return io(u)||t};r.metadataHandler=ci(iv,null,nf,hi);var rv="o",ro="f",uv="p",fv="c",ev="s",ov="l",ti="odata.",un="@"+ti+"bind",uo=ti+"metadata",sv=ti+"navigationLinkUrl",tr=ti+"type",uf={readLink:"self",editLink:"edit",nextLink:"__next",mediaReadLink:"media_src",mediaEditLink:"edit_media",mediaContentType:"content_type",mediaETag:"media_etag",count:"__count",media_src:"mediaReadLink",edit_media:"mediaEditLink",content_type:"mediaContentType",media_etag:"mediaETag",url:"uri"},h={metadata:"odata.metadata",count:"odata.count",next:"odata.nextLink",id:"odata.id",etag:"odata.etag",read:"odata.readLink",edit:"odata.editLink",mediaRead:"odata.mediaReadLink",mediaEdit:"odata.mediaEditLink",mediaEtag:"odata.mediaETag",mediaContentType:"odata.mediaContentType",actions:"odata.actions",functions:"odata.functions",navigationUrl:"odata.navigationLinkUrl",associationUrl:"odata.associationLinkUrl",type:"odata.type"},fn=function(n){if(n.indexOf(".")>0){var t=n.indexOf("@"),r=t>-1?n.substring(0,t):null,i=n.substring(t+1);return{target:r,name:i,isOData:i.indexOf(ti)===0}}return null},fo=function(n,t,i,r,u){return d(t)&&t[tr]||i&&i[n+"@"+tr]||r&&r.type||dw(r,u)||null},eo=function(n,t){return t?pt(t.property,n)||pt(t.navigationProperty,n):null},hv=function(n){return d(n)&&ti+"id"in n},en=function(n,t,i){if(!!t[n+"@"+sv]||i&&i.relationship)return!0;var r=e(t[n])?t[n][0]:t[n];return hv(r)},oo=function(n){return ee(n)||ue(n)||fe(n)},ii=function(n,t,i,r,u){var f,e;for(f in n)if(f.indexOf(".")>0&&f.charAt(0)!=="#"&&(e=fn(f),e)){var c=e.name,o=e.target,s=null,h=null;o&&(s=eo(o,r),h=fo(o,n[o],n,s,u));e.isOData?on(c,o,h,n[f],n,t,i):t[f]=n[f]}return t},on=function(n,t,i,r,u,f,e){var o=n.substring(ti.length);switch(o){case"navigationLinkUrl":ln(o,t,i,r,u,f,e);return;case"nextLink":case"count":hn(o,t,r,f,e);return;case"mediaReadLink":case"mediaEditLink":case"mediaContentType":case"mediaETag":cn(o,t,i,r,f,e);return;default:sn(o,t,r,f,e);return}},sn=function(n,t,i,r,u){var f=r.__metadata=r.__metadata||{},e=uf[n]||n,s,o;if(n==="editLink"){f.uri=c(i,u);f[e]=f.uri;return}if((n==="readLink"||n==="associationLinkUrl")&&(i=c(i,u)),t){if(s=f.properties=f.properties||{},o=s[t]=s[t]||{},n==="type"){o[e]=o[e]||i;return}o[e]=i;return}f[e]=i},hn=function(n,t,i,r,u){var f=uf[n],e=t?r[t]:r;e[f]=n==="nextLink"?c(i,u):i},cn=function(n,t,i,r,u,f){var e=u.__metadata=u.__metadata||{},h=uf[n],o,s;if((n==="mediaReadLink"||n==="mediaEditLink")&&(r=c(r,f)),t){o=e.properties=e.properties||{};s=o[t]=o[t]||{};s.type=s.type||i;u.__metadata=e;u[t]=u[t]||{__mediaresource:{}};u[t].__mediaresource[h]=r;return}e[h]=r},ln=function(n,t,i,r,u,f,e){var s=f.__metadata=f.__metadata||{},h=s.properties=s.properties||{},o=h[t]=h[t]||{},l=c(r,e);if(u.hasOwnProperty(t)){o.navigationLinkUrl=l;return}f[t]={__deferred:{uri:l}};o.type=o.type||i},so=function(n,t,i,r,u,f,o){if(typeof n=="string")return an(n,t,o);if(!oo(t)){if(e(n))return cv(n,t,i,r,f,o);if(d(n))return vn(n,t,i,r,f,o)}return n},an=function(n,t,i){switch(t){case vu:return le(n);case lu:return bu(n,!1);case au:return ce(n,!1)}return i?bu(n,!0)||ce(n,!0)||n:n},cv=function(n,t,i,r,u,f){for(var a=yu(t),o=[],h=[],e=0,c=n.length;e<c;e++){var s=fo(null,n[e])||a,l={type:s},v=so(n[e],s,l,r,null,u,f);oo(s)||wu(n[e])||o.push(l);h.push(v)}return o.length>0&&(i.elements=o),{__metadata:{type:t},results:h}},vn=function(n,t,i,r,u,f){var e=ff(n,{type:t},r,u,f),o=e.__metadata,s=o.properties;return s&&(i.properties=s,delete o.properties),e},yn=function(n,t,i,r,u){return e(n)?av(n,t,i,r,u):d(n)?ff(n,t,i,r,u):null},ff=function(n,i,r,u,f){var d,w,g,o,v,h,c,nt;i=i||{};var l=n[tr]||i.type||null,s=wt(l,u),k=!0;s||(k=!1,s=di(l,u));var y={type:l},a={__metadata:y},p={},e;if(k&&s&&i.entitySet&&i.contentTypeOdata=="minimalmetadata"){for(d=r.substring(0,r.lastIndexOf("$metadata")),e=null,s.key||(e=s);!!e&&!e.key&&e.baseType;)e=wt(e.baseType,u);(s.key||!!e&&e.key)&&(w=s.key?vv(n,s):vv(n,e),w&&(g={key:w,entitySet:i.entitySet,functionImport:i.functionImport,containerName:i.containerName},pn(n,g,l,d,s,e)))}for(o in n)if(o.indexOf("#")===0)lv(o.substring(1),n[o],a,r,u);else if(o.indexOf(".")===-1){for(y.properties||(y.properties=p),v=n[o],h=h=eo(o,s),e=s;!!s&&h===null&&e.baseType;)e=wt(e.baseType,u),h=h=eo(o,e);var tt=en(o,n,h),b=fo(o,v,n,h,u),it=p[o]=p[o]||{type:b};tt?(c={},i.entitySet!==t&&(nt=gw(h,i.entitySet.name,u),c=nb(nt,u)),c.contentTypeOdata=i.contentTypeOdata,c.kind=i.kind,c.type=b,a[o]=yn(v,c,r,u,f)):a[o]=so(v,b,it,r,h,u,f)}return ii(n,a,r,s,u)},lv=function(n,t,i,r,u){var f,s,g,nt;if(n&&(e(t)||d(t))){var l=!1,h=n.lastIndexOf("."),a=n.substring(h+1),v=h>-1?n.substring(0,h):"",y=a===n||v.indexOf(".")===-1?uc(u):fc(v,u);y&&(f=kw(y.functionImport,a),f&&!!f.isSideEffecting&&(l=!he(f.isSideEffecting)));for(var p=i.__metadata,w=l?"functions":"actions",tt=c(n,r),b=e(t)?t:[t],o=0,k=b.length;o<k;o++)s=b[o],s&&(g=p[w]=p[w]||[],nt={metadata:tt,title:s.title,target:c(s.target,r)},g.push(nt))}},av=function(n,t,i,r,u){for(var h=e(n)?n:n.value,c=[],a,f,s,o=0,l=h.length;o<l;o++)a=ff(h[o],t,i,r,u),c.push(a);if(f={results:c},d(n)){for(s in n)s.indexOf("#")===0&&(f.__metadata=f.__metadata||{},lv(s.substring(1),n[s],f,i,r));f=ii(n,f,i)}return f},vv=function(n,t){var u,i=t.key.propertyRef,f,e,r;if(u="(",i.length==1)f=pt(t.property,i[0].name).type,u+=ho(n[i[0].name],f);else for(e=!0,r=0;r<i.length;r++)e?e=!1:u+=",",f=pt(t.property,i[r].name).type,u+=i[r].name+"="+ho(n[i[r].name],f);return u+")"},pn=function(n,t,i,r,u,f){var o=n[h.id]||n[h.read]||n[h.edit]||t.entitySet.name+t.key,e;n[h.id]=r+o;n[h.edit]||(n[h.edit]=t.entitySet.name+t.key,t.entitySet.entityType!=i&&(n[h.edit]+="/"+i));n[h.read]=n[h.read]||n[h.edit];n[h.etag]||(e=wn(n,u,f),!e||(n[h.etag]=e));gn(n,u,f);bn(n,u,f);dn(n,t)},wn=function(n,t,i){for(var u="",f,r=0;t.property&&r<t.property.length;r++)f=t.property[r],u=yv(n,u,f);if(i)for(r=0;i.property&&r<i.property.length;r++)f=i.property[r],u=yv(n,u,f);return u.length>0?u+'"':null},yv=function(n,t,i){return i.concurrencyMode=="Fixed"&&(t+=t.length>0?",":'W/"',t+=n[i.name]!==null?ho(n[i.name],i.type):"null"),t},bn=function(n,i,r){for(var s="@odata.navigationLinkUrl",c="@odata.associationLinkUrl",u,e,o,f=0;i.navigationProperty&&f<i.navigationProperty.length;f++)u=i.navigationProperty[f].name,e=u+s,n[e]===t&&(n[e]=n[h.edit]+"/"+encodeURIComponent(u)),o=u+c,n[o]===t&&(n[o]=n[h.edit]+"/$links/"+encodeURIComponent(u));if(r&&r.navigationProperty)for(f=0;f<r.navigationProperty.length;f++)u=r.navigationProperty[f].name,e=u+s,n[e]===t&&(n[e]=n[h.edit]+"/"+encodeURIComponent(u)),o=u+c,n[o]===t&&(n[o]=n[h.edit]+"/$links/"+encodeURIComponent(u))},ho=function(n,t){n=""+kn(n,t);n=encodeURIComponent(n.replace(/'/g,"''"));switch(t){case"Edm.Binary":return"X'"+n+"'";case"Edm.DateTime":return"datetime'"+n+"'";case"Edm.DateTimeOffset":return"datetimeoffset'"+n+"'";case"Edm.Decimal":return n+"M";case"Edm.Guid":return"guid'"+n+"'";case"Edm.Int64":return n+"L";case"Edm.Float":return n+"f";case"Edm.Double":return n+"D";case"Edm.Geography":return"geography'"+n+"'";case"Edm.Geometry":return"geometry'"+n+"'";case"Edm.Time":return"time'"+n+"'";case"Edm.String":return"'"+n+"'";default:return n}},kn=function(n,t){switch(t){case"Edm.Binary":return ap(n);default:return n}},dn=function(n,i){for(var f,u=i.functionImport||[],r=0;r<u.length;r++)u[r].isBindable&&u[r].parameter[0]&&u[r].parameter[0].type==i.entitySet.entityType&&(f="#"+i.containerName+"."+u[r].name,n[f]==t&&(n[f]={title:u[r].name,target:n[h.edit]+"/"+u[r].name}))},gn=function(n,t,i){(t.hasStream||i&&i.hasStream)&&(n[h.mediaEdit]=n[h.mediaEdit]||n[h.mediaEdit]+"/$value",n[h.mediaRead]=n[h.mediaRead]||n[h.mediaEdit])},ntt=function(n,t,i,r){var u={type:t},f=so(n.value,t,u,i,null,null,r);return ii(n,{__metadata:u,value:f},i)},ttt=function(n,t,i,r,u){var f={},e=cv(n.value,t,f,i,r,u);return g(e.__metadata,f),ii(n,e,i)},itt=function(n,t){var r=n.value,u,i,f,o;if(!e(r))return pv(n,t);for(u=[],i=0,f=r.length;i<f;i++)u.push(pv(r[i],t));return o={results:u},ii(n,o,t)},pv=function(n,t){var i={uri:c(n.url,t)},u,r;return i=ii(n,i,t),u=i.__metadata||{},r=u.properties||{},ef(r.url),uu(r,"url","uri"),i},ef=function(n){n&&delete n.type},rtt=function(n,t){var o=n.value,s=[],h=ii(n,{collections:s},t),e=h.__metadata||{},i=e.properties||{},u,l,f,r;for(ef(i.value),uu(i,"value","collections"),u=0,l=o.length;u<l;u++)f=o[u],r={title:f.name,href:c(f.url,t)},r=ii(f,r,t),e=r.__metadata||{},i=e.properties||{},ef(i.name),ef(i.url),uu(i,"name","title"),uu(i,"url","href"),s.push(r);return{workspaces:[h]}},ri=function(n,t){return{kind:n,type:t||null}},utt=function(n,t,i){var f=n[uo],s,v,o,y,l,r,p,h,c,w,b,u,k;if(!f||typeof f!="string")return null;if(s=f.lastIndexOf("#"),s===-1)return ri(ev);if(v=f.indexOf("@Element",s),o=v-1,o<0&&(o=f.indexOf("?",s),o===-1&&(o=f.length)),y=decodeURIComponent(f.substring(s+1,o)),y.indexOf("/$links/")>0)return ri(ov);if(l=y.split("/"),l.length>=0){if(r=l[0],p=l[1],oo(r))return ri(uv,r);if(pu(r))return ri(fv,r);if(h=p,!p){var d=r.lastIndexOf("."),g=r.substring(d+1),a=g===r?uc(t):fc(r.substring(0,d),t);a&&(c=bw(a.entitySet,g),w=a.functionImport,b=a.name,h=!c?null:c.entityType)}return v>0?(u=ri(rv,h),u.entitySet=c,u.functionImport=w,u.containerName=b,u):h?(u=ri(ro,h),u.entitySet=c,u.functionImport=w,u.containerName=b,u):e(n.value)&&!di(r,t)&&(k=n.value[0],!wu(k)&&(hv(k)||!i))?ri(ro,null):ri(rv,r)}return null},ftt=function(n,t,i,r,u){var e,f,o;if(!d(n))return n;if(u=u||"minimalmetadata",e=n[uo],f=utt(n,t,r),et(f)&&(f.contentTypeOdata=u),o=null,f){delete n[uo];o=f.type;switch(f.kind){case ro:return av(n,f,e,t,i);case fv:return ttt(n,o,e,t,i);case uv:return ntt(n,o,e,i);case ev:return rtt(n,e);case ov:return itt(n,e)}}return ff(n,f,e,t,i)},wv=["type","etag","media_src","edit_media","content_type","media_etag"],bv=function(n,t){var i={},r=n.__metadata,u=t&&/\/\$links\//.test(t.request.requestUri);return co(n,r&&r.properties,i,u),i},ett=function(n,t){var i,u,r,f;if(n)for(i=0,u=wv.length;i<u;i++)r=wv[i],f=ti+(uf[r]||r),gr(f,null,n[r],t)},co=function(n,t,i,r){var u,f;for(u in n)f=n[u],u==="__metadata"?ett(f,i):u.indexOf(".")===-1?r&&u==="uri"?stt(f,i):ott(u,f,t,i,r):i[u]=f},ott=function(n,i,r,u){var e=r&&r[n]||{properties:t,type:t},f=ls(i,e);if(wu(i)||!i){gr(tr,n,f,u);u[n]=i;return}if(yr(i,f)||tc(i)){ltt(n,i,u);return}if(!f&&nc(i)){htt(n,i,u);return}if(gh(i,f)){yu(f)&&gr(tr,n,f,u);ctt(n,i,u);return}u[n]={};gr(tr,null,f,u[n]);co(i,e.properties,u[n])},stt=function(n,t){t.url=n},htt=function(n,t,i){gr(sv,n,t.__deferred.uri,i)},ctt=function(n,t,i){i[n]=[];var r=e(t)?t:t.results;co(r,null,i[n])},ltt=function(n,t,i){if(yr(t)){i[n]=[];for(var u=e(t)?t:t.results,r=0,f=u.length;r<f;r++)kv(n,u[r],!0,i);return}kv(n,t,!1,i)},kv=function(n,t,i,r){var f=t.__metadata&&t.__metadata.uri,u;if(f){att(n,f,i,r);return}if(u=bv(t),i){r[n].push(u);return}r[n]=u},att=function(n,t,i,r){var u=n+un;if(i){r[u]=r[u]||[];r[u].push(t);return}r[u]=t},gr=function(n,i,r,u){r!==t&&(i?u[i+"@"+n]=r:u[n]=r)},dv="application/json",gv=gi(dv),ny=function(n){var r=[],t,i,u;for(t in n)for(i=0,u=n[t].length;i<u;i++)r.push(g({metadata:t},n[t][i]));return r},vtt=function(n,t,i,r){var c,f,l,u,o,s,v,e,h,a;if(n&&typeof n=="object")if(f=n.__metadata,f&&(f.actions&&(f.actions=ny(f.actions)),f.functions&&(f.functions=ny(f.functions)),c=f&&f.type),l=wt(c,t)||di(c,t),l){if(o=l.property,o)for(s=0,v=o.length;s<v;s++)if(e=o[s],h=e.name,u=n[h],e.type==="Edm.DateTime"||e.type==="Edm.DateTimeOffset"){if(u){if(u=i(u),!u)throw{message:"Invalid date/time value"};n[h]=u}}else e.type==="Edm.Time"&&(n[h]=le(u))}else if(r)for(a in n)u=n[a],typeof u=="string"&&(n[a]=i(u)||u);return n},ty=function(n){if(n){var t=n.properties.odata;return t==="nometadata"||t==="minimalmetadata"||t==="fullmetadata"}return!1},ytt=function(n,t){for(var u={collections:[]},r,e,i=0,f=n.EntitySets.length;i<f;i++)r=n.EntitySets[i],e={title:r,href:c(r,t)},u.collections.push(e);return{workspaces:[u]}},ptt=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,wtt=function(n){var t,i;return n<0?(t="-",n=-n):t="+",i=Math.floor(n/60),n=n-60*i,t+a(i,2)+":"+a(n,2)},btt=function(n){var i=n&&ptt.exec(n),t,r,u;if(i&&(t=new Date(s(i[1])),i[2]&&(r=s(i[3]),i[2]==="-"&&(r=-r),u=t.getUTCMinutes(),t.setUTCMinutes(u-r),t.__edmType="Edm.DateTimeOffset",t.__offset=wtt(r)),!isNaN(t.valueOf())))return t},ktt=function(t,i,r){var f=it(r.recognizeDates,t.recognizeDates),h=it(r.inferJsonLightFeedAsObject,t.inferJsonLightFeedAsObject),e=r.metadata,o=r.dataServiceVersion,s=btt,u=typeof i=="string"?n.JSON.parse(i):i;if(ht("3.0",o)===o){if(ty(r.contentType))return ftt(u,e,f,h,r.contentType.properties.odata);s=bu}return u=ub(u.d,function(n,t){return vtt(t,e,s,f)}),u=tit(u,r.dataServiceVersion),nit(u,r.response.requestUri)},iy=function(t){var i,r=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return bh(this)};i=n.JSON.stringify(t,gtt)}finally{Date.prototype.toJSON=r}return i},dtt=function(n,i,r){var e=r.dataServiceVersion||"1.0",o=it(r.useJsonLight,n.useJsonLight),u=r.contentType=r.contentType||gv,f;return u&&u.mediaType===gv.mediaType?(f=i,o||ty(u))?(r.dataServiceVersion=ht(e,"3.0"),f=bv(i,r),iy(f)):(ht("3.0",e)===e&&(u.properties.odata="verbose",r.contentType=u),iy(f)):t},gtt=function(n,t){return t&&t.__edmType==="Edm.Time"?kh(t):t},nit=function(n,t){var i=d(n)&&!n.__metadata&&e(n.EntitySets);return i?ytt(n,t):n},tit=function(n,t){return t&&t.lastIndexOf(";")===t.length-1&&(t=t.substr(0,t.length-1)),t&&t!=="1.0"||e(n)&&(n={results:n}),n},of=ci(ktt,dtt,dv,hi);of.recognizeDates=!1;of.useJsonLight=!1;of.inferJsonLightFeedAsObject=!1;r.jsonHandler=of;var nu="multipart/mixed",iit=/^HTTP\/1\.\d (\d{3}) (.*)$/i,rit=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,lo=function(){return Math.floor((1+Math.random())*65536).toString(16).substr(1)},ry=function(n){return n+lo()+"-"+lo()+"-"+lo()},uy=function(n){return n.handler.partHandler},fy=function(n){var t=n.boundaries;return t[t.length-1]},uit=function(n,t,i){var r=i.contentType.properties.boundary;return{__batchResponses:ey(t,{boundaries:[r],handlerContext:i})}},fit=function(n,t,i){var r=i.contentType=i.contentType||gi(nu);if(r.mediaType===nu)return eit(t,i)},ey=function(n,t){var f="--"+fy(t),u,s,h,r,e,i;for(sf(n,t,f),ir(n,t),u=[];s!=="--"&&t.position<n.length;){if(h=oy(n,t),r=gi(h["Content-Type"]),r&&r.mediaType===nu){t.boundaries.push(r.properties.boundary);try{e=ey(n,t)}catch(o){o.response=sy(n,t,f);e=[o]}u.push({__changeResponses:e});t.boundaries.pop();sf(n,t,"--"+fy(t))}else{if(!r||r.mediaType!=="application/http")throw{message:"invalid MIME part type "};ir(n,t);i=sy(n,t,f);try{i.statusCode>=200&&i.statusCode<=299?uy(t.handlerContext).read(i,t.handlerContext):i={message:"HTTP request failed",response:i}}catch(o){i=o}u.push(i)}s=n.substr(t.position,2);ir(n,t)}return u},oy=function(n,t){var r={},i,u,f;do f=t.position,u=ir(n,t),i=rit.exec(u),i!==null?r[i[1]]=i[2]:t.position=f;while(u&&i);return se(r),r},sy=function(n,t,i){var o=t.position,r=iit.exec(ir(n,t)),u,f,e;return r?(u=r[1],f=r[2],e=oy(n,t),ir(n,t)):t.position=o,{statusCode:u,statusText:f,headers:e,body:sf(n,t,"\r\n"+i)}},ir=function(n,t){return sf(n,t,"\r\n")},sf=function(n,t,i){var u=t.position||0,r=n.length;if(i){if(r=n.indexOf(i,u),r===-1)return null;t.position=r+i.length}else t.position=r;return n.substring(u,r)},eit=function(n,t){var o;if(!yw(n))throw{message:"Data is not a batch object."};for(var r=ry("batch_"),f=n.__batchRequests,u="",i=0,e=f.length;i<e;i++)u+=hf(r,!1)+hy(f[i],t);return u+=hf(r,!0),o=t.contentType.properties,o.boundary=r,u},hf=function(n,t){var i="\r\n--"+n;return t&&(i+="--"),i+"\r\n"},hy=function(n,t,i){var s=n.__changeRequests,r,f,o,h,u;if(e(s)){if(i)throw{message:"Not Supported: change set nested in other change set"};for(f=ry("changeset_"),r="Content-Type: "+nu+"; boundary="+f+"\r\n",o=0,h=s.length;o<h;o++)r+=hf(f,!1)+hy(s[o],t,!0);r+=hf(f,!0)}else r="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n",u=g({},t),u.handler=ci,u.request=n,u.contentType=null,cc(n,uy(t),u),r+=oit(n);return r},oit=function(n){var t=(n.method?n.method:"GET")+" "+n.requestUri+" HTTP/1.1\r\n";for(var i in n.headers)n.headers[i]&&(t=t+i+": "+n.headers[i]+"\r\n");return t+="\r\n",n.body&&(t+=n.body),t};r.batchHandler=ci(uit,fit,nu,hi);ao=[r.jsonHandler,r.atomHandler,r.xmlHandler,r.textHandler];vo=function(n,t,i){for(var r=0,u=ao.length;r<u&&!ao[r][n](t,i);r++);if(r===u)throw{message:"no handler for data"};};r.defaultSuccess=function(t){n.alert(n.JSON.stringify(t))};r.defaultError=fu;r.defaultHandler={read:function(n,t){n&&et(n.body)&&n.headers["Content-Type"]&&vo("read",n,t)},write:function(n,t){vo("write",n,t)},maxDataServiceVersion:hi,accept:"application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1"};r.defaultMetadata=[];r.read=function(n,t,i,u,f,e){var o;return o=n instanceof String||typeof n=="string"?{requestUri:n}:n,r.request(o,t,i,u,f,e)};r.request=function(n,t,i,u,f,e){t=t||r.defaultSuccess;i=i||r.defaultError;u=u||r.defaultHandler;f=f||r.defaultHttpClient;e=e||r.defaultMetadata;n.recognizeDates=it(n.recognizeDates,r.jsonHandler.recognizeDates);n.callbackParameterName=it(n.callbackParameterName,r.defaultHttpClient.callbackParameterName);n.formatQueryString=it(n.formatQueryString,r.defaultHttpClient.formatQueryString);n.enableJsonpCallback=it(n.enableJsonpCallback,r.defaultHttpClient.enableJsonpCallback);n.useJsonLight=it(n.useJsonLight,r.jsonHandler.enableJsonpCallback);n.inferJsonLightFeedAsObject=it(n.inferJsonLightFeedAsObject,r.jsonHandler.inferJsonLightFeedAsObject);var o={metadata:e,recognizeDates:n.recognizeDates,callbackParameterName:n.callbackParameterName,formatQueryString:n.formatQueryString,enableJsonpCallback:n.enableJsonpCallback,useJsonLight:n.useJsonLight,inferJsonLightFeedAsObject:n.inferJsonLightFeedAsObject};try{return cc(n,u,o),vw(n,t,i,u,f,o)}catch(s){i(s)}};r.parseMetadata=function(n){return iv(null,n)};r.batchHandler.partHandler=r.defaultHandler;var sit=function(){var n={v:this.valueOf(),t:"[object Date]"};for(var t in this)n[t]=this[t];return n},hit=function(n,t){var r,i;if(t&&t.t==="[object Date]"){r=new Date(t.v);for(i in t)i!=="t"&&i!=="v"&&(r[i]=t[i]);t=r}return t},cf=function(n,t){return n.name+"#!#"+t},cy=function(n,t){return t.replace(n.name+"#!#","")},v=function(n,t){return this.name=n,this.storage=t,this};v.isSupported=function(){return!!n.localStorage};v.prototype.add=function(n,t,i,r){r=r||this.defaultError;var u=this;this.contains(n,function(f){f?o(r,{message:"key already exists",key:n}):u.addOrUpdate(n,t,i,r)},r)};v.prototype.addOrUpdate=function(i,r,u,f){var h,c,e;if(f=f||this.defaultError,i instanceof Array)f({message:"Array of keys not supported"});else{h=cf(this,i);c=Date.prototype.toJSON;try{e=r;e!==t&&(Date.prototype.toJSON=sit,e=n.JSON.stringify(r));this.storage.setItem(h,e);o(u,i,r)}catch(s){s.code===22||s.number===2147942414?o(f,{name:"QUOTA_EXCEEDED_ERR",error:s}):o(f,s)}finally{Date.prototype.toJSON=c}}};v.prototype.clear=function(n,t){var i,r,u,f;t=t||this.defaultError;try{for(i=0,r=this.storage.length;r>0&&i<r;)u=this.storage.key(i),f=cy(this,u),u!==f?(this.storage.removeItem(u),r=this.storage.length):i++;o(n)}catch(e){o(t,e)}};v.prototype.close=function(){};v.prototype.contains=function(n,t,i){i=i||this.defaultError;try{var r=cf(this,n),u=this.storage.getItem(r);o(t,u!==null)}catch(f){o(i,f)}};v.prototype.defaultError=fu;v.prototype.getAllKeys=function(n,t){var r,i,e,u,f;t=t||this.defaultError;r=[];try{for(i=0,e=this.storage.length;i<e;i++)u=this.storage.key(i),f=cy(this,u),u!==f&&r.push(f);o(n,r)}catch(s){o(t,s)}};v.prototype.read=function(i,r,u){if(u=u||this.defaultError,i instanceof Array)u({message:"Array of keys not supported"});else try{var e=cf(this,i),f=this.storage.getItem(e);f=f!==null&&f!=="undefined"?n.JSON.parse(f,hit):t;o(r,i,f)}catch(s){o(u,s)}};v.prototype.remove=function(n,t,i){if(i=i||this.defaultError,n instanceof Array)i({message:"Batches not supported"});else try{var r=cf(this,n);this.storage.removeItem(r);o(t)}catch(u){o(i,u)}};v.prototype.update=function(n,t,i,r){r=r||this.defaultError;var u=this;this.contains(n,function(f){f?u.addOrUpdate(n,t,i,r):o(r,{message:"key not found",key:n})},r)};rr=function(t){return v.call(this,t,n.localStorage),this};ns(rr,v);rr.prototype.mechanism="localstorage";rr.create=function(n){if(v.isSupported())return new rr(n);throw{message:"Web Storage not supported by the browser"};};ur=function(t){return v.call(this,t,n.sessionStorage),this};ns(ur,v);ur.prototype.mechanism="sessionstorage";ur.create=function(n){if(v.isSupported())return new ur(n);throw{message:"Web Storage not supported by the browser"};};var ly=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB,cit=n.IDBKeyRange||n.webkitIDBKeyRange,ay=n.IDBTransaction||n.webkitIDBTransaction||{},vy=ay.READ_ONLY||"readonly",fr=ay.READ_WRITE||"readwrite",at=function(n,t){return function(i){var r=n||t,u,f;if(r){if(Object.prototype.toString.call(i)==="[object IDBDatabaseException]"){if(i.code===11){r({name:"QuotaExceededError",error:i});return}r(i);return}try{f=i.target.error||i;u=f.name}catch(e){u=i.type==="blocked"?"IndexedDBBlocked":"UnknownError"}r({name:u,error:i})}}},lit=function(n,t,i){var u=n.name,f="_datajs_"+u,r=ly.open(f);r.onblocked=i;r.onerror=i;r.onupgradeneeded=function(){var n=r.result;n.objectStoreNames.contains(u)||n.createObjectStore(u)};r.onsuccess=function(n){var f=r.result,e;if(!f.objectStoreNames.contains(u)){if("setVersion"in f){e=f.setVersion("1.0");e.onsuccess=function(){var n=e.transaction;n.oncomplete=function(){t(f)};f.createObjectStore(u,null,!1)};e.onerror=i;e.onblocked=i;return}n.target.error={name:"DBSchemaMismatch"};i(n);return}f.onversionchange=function(n){n.target.close()};t(f)}},ui=function(n,t,i,r){var u=n.name,f=n.db,e=at(r,n.defaultError);if(f){i(f.transaction(u,t));return}lit(n,function(r){n.db=r;i(r.transaction(u,t))},e)},w=function(n){this.name=n};w.create=function(n){if(w.isSupported())return new w(n);throw{message:"IndexedDB is not supported on this browser"};};w.isSupported=function(){return!!ly};w.prototype.add=function(n,t,i,r){var e=this.name,o=this.defaultError,u=[],f=[];n instanceof Array?(u=n,f=t):(u=[n],f=[t]);ui(this,fr,function(s){s.onabort=at(r,o,n,"add");s.oncomplete=function(){n instanceof Array?i(u,f):i(n,t)};for(var h=0;h<u.length&&h<f.length;h++)s.objectStore(e).add({v:f[h]},u[h])},r)};w.prototype.addOrUpdate=function(n,t,i,r){var e=this.name,o=this.defaultError,u=[],f=[];n instanceof Array?(u=n,f=t):(u=[n],f=[t]);ui(this,fr,function(s){var h,c;for(s.onabort=at(r,o),s.oncomplete=function(){n instanceof Array?i(u,f):i(n,t)},h=0;h<u.length&&h<f.length;h++)c={v:f[h]},s.objectStore(e).put(c,u[h])},r)};w.prototype.clear=function(n,t){var i=this.name,r=this.defaultError;ui(this,fr,function(u){u.onerror=at(t,r);u.oncomplete=function(){n()};u.objectStore(i).clear()},t)};w.prototype.close=function(){this.db&&(this.db.close(),this.db=null)};w.prototype.contains=function(n,t,i){var r=this.name,u=this.defaultError;ui(this,vy,function(f){var e=f.objectStore(r),o=e.get(n);f.oncomplete=function(){t(!!o.result)};f.onerror=at(i,u)},i)};w.prototype.defaultError=fu;w.prototype.getAllKeys=function(n,t){var i=this.name,r=this.defaultError;ui(this,fr,function(u){var e=[],f;u.oncomplete=function(){n(e)};f=u.objectStore(i).openCursor();f.onerror=at(t,r);f.onsuccess=function(n){var t=n.target.result;t&&(e.push(t.key),t["continue"].call(t))}},t)};w.prototype.mechanism="indexeddb";w.prototype.read=function(n,i,r){var f=this.name,e=this.defaultError,u=n instanceof Array?n:[n];ui(this,vy,function(o){var h=[],s,c,l;for(o.onerror=at(r,e,n,"read"),o.oncomplete=function(){n instanceof Array?i(u,h):i(u[0],h[0])},s=0;s<u.length;s++)c=o.objectStore(f),l=c.get.call(c,u[s]),l.onsuccess=function(n){var i=n.target.result;h.push(i?i.v:t)}},r)};w.prototype.remove=function(n,t,i){var u=this.name,f=this.defaultError,r=n instanceof Array?n:[n];ui(this,fr,function(n){var e,o;for(n.onerror=at(i,f),n.oncomplete=function(){t()},e=0;e<r.length;e++)o=n.objectStore(u),o["delete"].call(o,r[e])},i)};w.prototype.update=function(n,t,i,r){var e=this.name,o=this.defaultError,u=[],f=[];n instanceof Array?(u=n,f=t):(u=[n],f=[t]);ui(this,fr,function(s){var h,c,l;for(s.onabort=at(r,o),s.oncomplete=function(){n instanceof Array?i(u,f):i(n,t)},h=0;h<u.length&&h<f.length;h++)c=s.objectStore(e).openCursor(cit.only(u[h])),l={v:f[h]},c.pair={key:u[h],value:l},c.onsuccess=function(n){var t=n.target.result;t?t.update(n.target.pair.value):s.abort()}},r)};fi=function(n){var e=[],r=[],i={},u,f;this.name=n;u=function(n){return n||this.defaultError};f=function(n,i){var r;return(n instanceof Array&&(r="Array of keys not supported"),(n===t||n===null)&&(r="Invalid key"),r)?(o(i,{message:r}),!1):!0};this.add=function(n,t,r,e){e=u(e);f(n,e)&&(i.hasOwnProperty(n)?e({message:"key already exists",key:n}):this.addOrUpdate(n,t,r,e))};this.addOrUpdate=function(n,s,h,c){if(c=u(c),f(n,c)){var l=i[n];l===t&&(l=e.length>0?e.splice(0,1):r.length);r[l]=s;i[n]=l;o(h,n,s)}};this.clear=function(n){r=[];i={};e=[];o(n)};this.contains=function(n,t){var r=i.hasOwnProperty(n);o(t,r)};this.getAllKeys=function(n){var t=[];for(var r in i)t.push(r);o(n,t)};this.read=function(n,t,e){if(e=u(e),f(n,e)){var s=i[n];o(t,n,r[s])}};this.remove=function(n,s,h){if(h=u(h),f(n,h)){var c=i[n];c!==t&&(c===r.length-1?r.pop():(r[c]=t,e.push(c)),delete i[n],r.length===0&&(e=[]));o(s)}};this.update=function(n,t,r,e){e=u(e);f(n,e)&&(i.hasOwnProperty(n)?this.addOrUpdate(n,t,r,e):e({message:"key not found",key:n}))}};fi.create=function(n){return new fi(n)};fi.isSupported=function(){return!0};fi.prototype.close=function(){};fi.prototype.defaultError=fu;fi.prototype.mechanism="memory";yy={indexeddb:w,localstorage:rr,sessionstorage:ur,memory:fi};vt.defaultStoreMechanism="best";vt.createStore=function(n,t){var i;if(n=n||"datajs",t||(t=vt.defaultStoreMechanism),t==="best"&&(t=v.isSupported()?"localstorage":"memory"),i=yy[t],i)return i.create(n);throw{message:"Failed to create store",name:n,mechanism:t};};var ait=function(n,t){var i=n.indexOf("?")>=0?"&":"?";return n+i+t},vit=function(n,t){var i=n.indexOf("?"),r="";return i>=0&&(r=n.substr(i),n=n.substr(0,i)),n[n.length-1]!=="/"&&(n+="/"),n+t+r},py=function(n,t){return{method:"GET",requestUri:n,user:t.user,password:t.password,enableJsonpCallback:t.enableJsonpCallback,callbackParameterName:t.callbackParameterName,formatQueryString:t.formatQueryString}},nrt=function(n,t){var u=-1,r=n.indexOf("?"),i;return r!==-1&&(i=n.indexOf("?"+t+"=",r),i===-1&&(i=n.indexOf("&"+t+"=",r)),i!==-1&&(u=i+t.length+2)),u},yit=function(n,t,i,r){return wy(n,t,[],i,r)},wy=function(n,i,u,f,e){var s=py(n,i),o=r.request(s,function(n){var t=n.__next,r=n.results;u=u.concat(r);t?o=wy(t,i,u,f,e):f(u)},e,t,i.httpClient,i.metadata);return{abort:function(){o.abort()}}},pit=function(n){var i=this,u=n.source;return i.identifier=hp(encodeURI(decodeURI(u))),i.options=n,i.count=function(n,f){var e=i.options;return r.request(py(vit(u,"$count"),e),function(t){var i=s(t.toString());isNaN(i)?f({message:"Count is NaN",count:i}):n(i)},f,t,e.httpClient,e.metadata)},i.read=function(n,t,r,f){var e="$skip="+n+"&$top="+t;return yit(ait(u,e),i.options,r,f)},i},wit=function(n,t){var r=bit(n,t),i,u;r&&(i=r.i-t.i,u=i+(n.c-n.d.length),n.d=n.d.concat(t.d.slice(i,u)))},bit=function(n,t){var r=n.i+n.c,u=t.i+t.c,i=n.i>t.i?n.i:t.i,f=r<u?r:u,e;return f>=i&&(e={i:i,c:f-i}),e},by=function(n,i){if(n===t||typeof n!="number")throw{message:"'"+i+"' must be a number."};if(isNaN(n)||n<0||!isFinite(n))throw{message:"'"+i+"' must be greater than or equal to zero."};},kit=function(n,i){if(n!==t){if(typeof n!="number")throw{message:"'"+i+"' must be a number."};if(isNaN(n)||n<=0||!isFinite(n))throw{message:"'"+i+"' must be greater than zero."};}},ky=function(n,i){if(n!==t&&(typeof n!="number"||isNaN(n)||!isFinite(n)))throw{message:"'"+i+"' must be a number."};},yo=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return n.splice(i,1),!0;return!1},dy=function(n){var t=0,r=typeof n,i;if(r==="object"&&n)for(i in n)t+=i.length*2+dy(n[i]);else t=r==="string"?n.length*2:8;return t},gy=function(n,t,i){return n=Math.floor(n/i)*i,t=Math.ceil((t+1)/i)*i,{i:n,c:t-n}},lf="destroy",ai="idle",np="init",po="read",wo="prefetch",bo="write",tu="cancel",ei="end",ko="error",vi="start",tp="wait",ip="clear",iu="done",ru="local",rp="save",up="source",er=function(n,t,i,r,u,f,e){var h,c,o=this,l,s;return o.p=t,o.i=r,o.c=u,o.d=f,o.s=vi,o.canceled=!1,o.pending=e,o.oncomplete=null,o.cancel=function(){if(i){var n=o.s;n!==ko&&n!==ei&&n!==tu&&(o.canceled=!0,s(tu,h))}},o.complete=function(){s(ei,h)},o.error=function(n){o.canceled||s(ko,n)},o.run=function(n){c=n;o.transition(o.s,h)},o.wait=function(n){s(tp,n)},l=function(t,i,r){switch(t){case vi:i!==np&&n(o,t,i,r);break;case tp:n(o,t,i,r);break;case tu:n(o,t,i,r);o.fireCanceled();s(ei);break;case ko:n(o,t,i,r);o.canceled=!0;o.fireRejected(r);s(ei);break;case ei:if(o.oncomplete)o.oncomplete(o);o.canceled||o.fireResolved();n(o,t,i,r);break;default:n(o,t,i,r)}},s=function(n,t){o.s=n;h=t;l(n,c,t)},o.transition=s,o};er.prototype.fireResolved=function(){var n=this.p;n&&(this.p=null,n.resolve(this.d))};er.prototype.fireRejected=function(n){var t=this.p;t&&(this.p=null,t.reject(n))};er.prototype.fireCanceled=function(){this.fireRejected({canceled:!0,message:"Operation canceled"})};fp=function(i){var it=np,y={counts:0,netReads:0,prefetches:0,cacheReads:0},c=[],b=[],p=[],nt=0,l=!1,k=yf(i.cacheSize,1048576),a=0,h=0,d=0,tt=k===0,r=yf(i.pageSize,50),ut=yf(i.prefetchSize,r),ht="1.0",f,ft=0,w=i.source,v,u;typeof w=="string"&&(w=new pit(i));w.options=i;v=vt.createStore(i.name,i.mechanism);u=this;u.onidle=i.idle;u.stats=y;u.count=function(){var n,i,t;if(f)throw f;return(n=cu(),i=!1,l)?(o(function(){n.resolve(a)}),n.promise()):(t=w.count(function(i){t=null;y.counts++;n.resolve(i)},function(r){t=null;n.reject(g(r,{canceled:i}))}),g(n.promise(),{cancel:function(){t&&(i=!0,t.abort(),t=null)}}))};u.clear=function(){if(f)throw f;if(c.length===0){var n=cu(),t=new er(ii,n,!1);return ot(t,c),n.promise()}return c[0].p};u.filterForward=function(n,t,i){return lt(n,t,i,!1)};u.filterBack=function(n,t,i){return lt(n,t,i,!0)};u.readRange=function(n,t){if(by(n,"index"),by(t,"count"),f)throw f;var i=cu(),r=new er(ui,i,!0,n,t,[],0);return ot(r,b),g(i.promise(),{cancel:function(){r.cancel()}})};u.ToObservable=u.toObservable=function(){if(!n.Rx||!n.Rx.Observable)throw{message:"Rx library not available - include rx.js"};if(f)throw f;return n.Rx.Observable.CreateWithDisposable(function(n){var t=!1,i=0,f=function(i){t||n.OnError(i)},e=function(o){if(!t){for(var s=0,h=o.length;s<h;s++)n.OnNext(o[s]);o.length<r?n.OnCompleted():(i+=r,u.readRange(i,r).then(e,f))}};return u.readRange(i,r).then(e,f),{Dispose:function(){t=!0}}})};var rt=function(n){return function(t){f={message:n,error:t};for(var i=0,r=b.length;i<r;i++)b[i].fireRejected(f);for(i=0,r=c.length;i<r;i++)c[i].fireRejected(f);b=c=null}},e=function(n){if(n!==it){it=n;for(var i=c.concat(b,p),t=0,r=i.length;t<r;t++)i[t].run(it)}},ct=function(){var n=new ki;return v.clear(function(){nt=0;l=!1;a=0;h=0;d=0;tt=k===0;y={counts:0,netReads:0,prefetches:0,cacheReads:0};u.stats=y;v.close();n.resolve()},function(t){n.reject(t)}),n},kt=function(n){var t=yo(c,n);t||(t=yo(b,n),t||yo(p,n));ft--;e(ai)},dt=function(n){var t=new ki,u=!1,i=w.read(n,r,function(i){var r={i:n,c:i.length,d:i};t.resolve(r)},function(n){t.reject(n)});return g(t,{cancel:function(){i&&(i.abort(),u=!0,i=null)}})},lt=function(n,t,i,e){if(n=s(n),t=s(t),isNaN(n))throw{message:"'index' must be a valid number.",index:n};if(isNaN(t))throw{message:"'count' must be a valid number.",count:t};if(f)throw f;n=Math.max(n,0);var h=cu(),o=[],a=!1,l=null,v=function(n,f){a||(t>=0&&o.length>=t?h.resolve(o):l=u.readRange(n,f).then(function(u){for(var l,a,y,p,s=0,c=u.length;s<c&&(t<0||o.length<t);s++)l=e?c-s-1:s,a=u[l],i(a)&&(y={index:n+l,item:a},e?o.unshift(y):o.push(y));!e&&u.length<f||e&&n<=0?h.resolve(o):(p=e?Math.max(n-r,0):n+f,v(p,r))},function(n){h.reject(n)}))},c=gy(n,n,r),y=e?c.i:n,p=e?n-c.i+1:c.i+c.c-n;return v(y,p),g(h.promise(),{cancel:function(){l&&l.cancel();a=!0}})},at=function(){u.onidle&&ft===0&&u.onidle()},gt=function(n){if(!l&&ut!==0&&!tt&&(p.length===0||p[0]&&p[0].c!==-1)){var t=new er(ri,null,!0,n,ut,null,ut);ot(t,p)}},ot=function(n,t){n.oncomplete=kt;t.push(n);ft++;n.run(it)},ni=function(n){var r=!1,i=g(new ki,{cancel:function(){r=!0}}),u=yt(i,"Read page from store failure");return v.contains(n,function(f){if(!r){if(f){v.read(n,function(n,u){r||i.resolve(u!==t,u)},u);return}i.resolve(!1)}},u),i},ti=function(n,t){var e=!1,i=g(new ki,{cancel:function(){e=!0}}),r=yt(i,"Save page to store failure"),u=function(){i.resolve(!0)},f;return t.c>0?(f=dy(t),tt=k>=0&&k<nt+f,tt?u():v.addOrUpdate(n,t,function(){pt(t,f);st(u,r)},r)):(pt(t,0),st(u,r)),i},st=function(n,t){var i={actualCacheSize:nt,allDataLocal:l,cacheSize:k,collectionCount:a,highestSavedPage:h,highestSavedPageSize:d,pageSize:r,sourceId:w.identifier,version:ht};v.addOrUpdate("__settings",i,n,t)},yt=function(n){return function(){n.resolve(!1)}},pt=function(n,t){var i=n.c,u=n.i;i===0?h===u-r&&(a=h+d):(h=Math.max(h,u),h===u&&(d=i),nt+=t,i<r&&!a&&(a=u+i));l||a!==h+d||(l=!0)},wt=function(n,t,i,r){var u=n.canceled&&t!==ei;return u&&t===tu&&r&&r.cancel&&r.cancel(),u},ii=function(n,t,i){var r=n.transition;if(i!==lf)return e(lf),!0;switch(t){case vi:r(ip);break;case ei:at();break;case ip:ct().then(function(){n.complete()});n.wait();break;default:return!1}return!0},ri=function(n,t,i,u){var o,f;if(!wt(n,t,i,u)){if(o=n.transition,i!==wo)return i===lf?t!==tu&&n.cancel():i===ai&&e(wo),!0;switch(t){case vi:p[0]===n&&o(ru,n.i);break;case iu:f=n.pending;f>0&&(f-=Math.min(f,u.c));l||f===0||u.c<r||tt?n.complete():(n.pending=f,o(ru,u.i+r));break;default:return bt(n,t,i,u,!0)}}return!0},ui=function(n,t,i,u){var f,o,s;if(!wt(n,t,i,u)){if(f=n.transition,i!==po&&t!==vi)return i===lf?t!==vi&&n.cancel():i!==bo&&e(po),!0;switch(t){case vi:(i===ai||i===wo)&&(e(po),n.c>0?(o=gy(n.i,n.c,r),f(ru,o.i)):f(iu,n));break;case iu:wit(n,u);s=n.d.length;n.c===s||u.c<r?(y.cacheReads++,gt(u.i+u.c),n.complete()):f(ru,u.i+r);break;default:return bt(n,t,i,u,!1)}}return!0},bt=function(n,t,i,r,u){var s=n.error,o=n.transition,h=n.wait,f;switch(t){case ei:at();break;case ru:f=ni(r).then(function(t,i){n.canceled||(t?o(iu,i):o(up,r))});break;case up:f=dt(r).then(function(t){n.canceled||(u?y.prefetches++:y.netReads++,o(rp,t))},s);break;case rp:i!==bo&&(e(bo),f=ti(r.i,r).then(function(t){n.canceled||(!t&&u&&(n.pending=0),o(iu,r));e(ai)}));break;default:return!1}return f&&(n.canceled?f.cancel():n.s===t&&h(f)),!0};return v.read("__settings",function(n,t){if(et(t)){var i=t.version;if(!i||i.indexOf("1.")!==0){rt("Unsupported cache store version "+i)();return}r!==t.pageSize||w.identifier!==t.sourceId?ct().then(function(){e(ai)},rt("Unable to clear store during initialization")):(nt=t.actualCacheSize,l=t.allDataLocal,k=t.cacheSize,a=t.collectionCount,h=t.highestSavedPage,d=t.highestSavedPageSize,ht=i,e(ai))}else st(function(){e(ai)},rt("Unable to write settings during initialization."))},rt("Unable to read settings from store.")),u};vt.createDataCache=function(n){if(kit(n.pageSize,"pageSize"),ky(n.cacheSize,"cacheSize"),ky(n.prefetchSize,"prefetchSize"),!et(n.name))throw{message:"Undefined or null name",options:n};if(!et(n.source))throw{message:"Undefined source",options:n};return new fp(n)}})(this);
//# sourceMappingURL=datajs-1.1.3.min.js.map
